<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>Efficient compression of congruence class automations | ZeroBone</title><meta name="generator" content="Jekyll v3.8.6" /><meta property="og:title" content="Efficient compression of congruence class automations" /><meta name="author" content="Alexander Mayorov" /><meta property="og:locale" content="en" /><meta name="description" content="As already discussed in the previous post, any radix-b number n with n \bmod{m} \in E \subseteq Z can be accepted by finite automata in a digit-by-digit manner. However, the construction is not always optimal. The amount of states required is not always the amount of congruence classes. In this post we will examine when exactly the finite automata can be simplified by combining states. Reducing the amount of states will also help produce a much simpler regular expression, for example, with the Kleene construction." /><meta property="og:description" content="As already discussed in the previous post, any radix-b number n with n \bmod{m} \in E \subseteq Z can be accepted by finite automata in a digit-by-digit manner. However, the construction is not always optimal. The amount of states required is not always the amount of congruence classes. In this post we will examine when exactly the finite automata can be simplified by combining states. Reducing the amount of states will also help produce a much simpler regular expression, for example, with the Kleene construction." /><link rel="canonical" href="https://zerobone.net/blog/cs/2020-09-01-compressing-congruence-automata/" /><meta property="og:url" content="https://zerobone.net/blog/cs/2020-09-01-compressing-congruence-automata/" /><meta property="og:site_name" content="ZeroBone" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-01T00:00:00+02:00" /> <script type="application/ld+json"> {"url":"https://zerobone.net/blog/cs/2020-09-01-compressing-congruence-automata/","headline":"Efficient compression of congruence class automations","dateModified":"2020-09-01T00:00:00+02:00","datePublished":"2020-09-01T00:00:00+02:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://zerobone.net/assets/icons/icon.png"},"name":"Alexander Mayorov"},"author":{"@type":"Person","name":"Alexander Mayorov"},"description":"As already discussed in the previous post, any radix-b number n with n \\bmod{m} \\in E \\subseteq Z can be accepted by finite automata in a digit-by-digit manner. However, the construction is not always optimal. The amount of states required is not always the amount of congruence classes. In this post we will examine when exactly the finite automata can be simplified by combining states. Reducing the amount of states will also help produce a much simpler regular expression, for example, with the Kleene construction.","mainEntityOfPage":{"@type":"WebPage","@id":"https://zerobone.net/blog/cs/2020-09-01-compressing-congruence-automata/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><meta name="keywords" content="ZeroBone,Programming,Computer Science,Alexander,Mayorov,Math"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="ZeroBone"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="application-name" content="ZeroBone"><meta name="msapplication-config" content="/assets/ieconfig.xml"><meta name="theme-color" content="rgb(25,55,71)"><meta name="generator" content="ZeroBone" /><link type="application/atom+xml" rel="alternate" href="https://zerobone.net/feed.xml" title="ZeroBone" /><link rel="alternate" href="https://zerobone.net/blog/cs/2020-09-01-compressing-congruence-automata/" hreflang="en"><link rel="shortcut icon" href="/assets/icons/favicon.ico"><link rel="apple-touch-icon" href="/assets/icons/icon.png"><link rel="manifest" href="/assets/manifest.json"><link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="dns-prefetch" href="/" id="_baseURL"><link rel="dns-prefetch" href="/sw.js" id="_hrefSW"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.js" id="_hrefKatexJS"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css" id="_hrefKatexCSS"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/contrib/copy-tex.min.js" id="_hrefKatexCopyJS"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/contrib/copy-tex.min.css" id="_hrefKatexCopyCSS"><link rel="dns-prefetch" href="/assets/img/swipe.svg" id="_hrefSwipeSVG"> <script> !function(e,t){"use strict";function n(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}e.loadJS=function(e,o){var r=t.createElement("script");r.src=e,o&&n(r,"load",o,{once:!0});var a=t.scripts[0];return a.parentNode.insertBefore(r,a),r},e._loaded=!1,e.loadJSDeferred=function(o,r){function a(){e._loaded=!0,r&&n(c,"load",r,{once:!0});var o=t.scripts[0];o.parentNode.insertBefore(c,o)}var c=t.createElement("script");return c.src=o,e._loaded?a():n(e,"load",a,{once:!0}),c},e.setRel=e.setRelStylesheet=function(e){function o(){this.rel="stylesheet"}n(t.getElementById(e),"load",o,{once:!0})}}(window,document); ; !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); ; !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); ; !function(w, d) { w._noPushState = false; w._noDrawer = false; }(window, document); </script> <!--[if gt IE 8]><!----><style> body{--code-font-family: Menlo,Monaco,Consolas,monospace;--font-weight: 400;--font-weight-bold: 700;--font-weight-heading: 400;--text-muted: #888;--gray-bg: rgba(0,0,0,0.025);--gray-text: #666;--menu-text: #bbb;--body-color: #333;--body-bg: #fff;--border-color: #ebebeb}.clearfix,.sidebar-social::after{content:"";display:table;clear:both}.color-transition,body,p,hr,.hr,table:not(.highlight) td,table:not(.highlight) th,.message{transition:background-color 1s ease, border-color 1s ease}.no-color-transition{transition:none !important}@media screen{body.light-mode{--text-muted: #888;--gray-bg: rgba(0,0,0,0.025);--gray-text: #666;--menu-text: #bbb;--body-color: #333;--body-bg: #fff;--border-color: #ebebeb}body.dark-mode{--text-muted: rgba(255,255,255,.5);--gray-bg: rgba(255,255,255,.033);--gray-text: rgba(255,255,255,.625);--menu-text: rgba(255,255,255,.25);--body-color: #ccc;--body-bg: #2d3539;--border-color: #3d494f}}*{box-sizing:border-box}html,body{margin:0;padding:0}html{font-size:16px;line-height:1.75}body{color:var(--body-color);background-color:var(--body-bg);font-weight:var(--font-weight);overflow-y:scroll}a{text-decoration:none}.lead{margin-left:-1rem;margin-right:-1rem}.content img,.img,.content video,.video{max-width:100%}.content img.lead,.img.lead,.content video.lead,.video.lead{max-width:calc(100% + 2rem);width:calc(100% + 2rem)}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{font-weight:var(--font-weight-heading);margin:5rem 0 1rem}h1,.h1{font-size:2rem;line-height:1.3}h2,.h2{font-size:1.5rem;line-height:1.4}h3,.h3{font-size:1.17em;line-height:1.5}h4,h5,h6,.h4,.h5,.h6{font-size:1rem;margin-bottom:0.5rem}p{margin-top:0;margin-bottom:1rem}p.lead{font-size:1.2em;margin-top:1.5rem;margin-bottom:1.5rem;padding:0 1rem}ul,ol,dl{margin-top:0;margin-bottom:1rem}ul,ol{padding-left:1.25rem}hr{position:relative;margin:3rem 0;border:0;border-top:1px solid var(--border-color)}.hr{border-bottom:1px solid var(--border-color);padding-bottom:1rem;margin-bottom:2rem}table:not(.highlight){border-collapse:collapse;margin-bottom:2rem;margin-left:-1rem}table:not(.highlight) td,table:not(.highlight) th{padding:.25rem .5rem;border:1px solid var(--border-color)}table:not(.highlight) td:first-child,table:not(.highlight) th:first-child{padding-left:1rem}table:not(.highlight) td:last-child,table:not(.highlight) th:last-child{padding-right:1rem}.page{margin-bottom:3em}.page li+li{margin-top:.25rem}.page>header{margin-bottom:2rem}.page-title,.post-title{margin-top:0}.post-date{display:block;margin-top:-0.5rem;margin-bottom:1rem;color:var(--text-muted)}.related-posts{padding-left:0;list-style:none;margin-bottom:2rem}.related-posts>li,.related-posts>li+li{margin-top:1rem}.message{margin-bottom:1rem;padding:1rem;color:var(--gray-text);background-color:var(--gray-bg);margin-left:-1rem;margin-right:-1rem}@media screen{body::before{content:'';width:.5rem;background:var(--border-color);position:fixed;left:0;top:0;bottom:0}}@media screen and (min-width: 64em){body::before{width:21rem}}@media screen and (min-width: 1666px){body::before{width:calc(50% - 28rem)}}@media screen and (min-width: 42em){html{font-size:17px}}@media screen and (min-width: 124em){html{font-size:18px}}.fade-in{animation-duration:500ms;animation-timing-function:ease;animation-name:fade-in;animation-fill-mode:forwards}@keyframes fade-in{from{transform:translateY(-3rem);opacity:0}50%{transform:translateY(-3rem);opacity:0}to{transform:translateY(0);opacity:1}}.fl{float:left}.fr{float:right}.mb4{margin-bottom:4rem}.mb6{margin-bottom:6rem}.mt0{margin-top:0}.mt2{margin-top:2rem}.mt3{margin-top:3rem}.mt4{margin-top:4rem}.pb0{padding-bottom:0}.sixteen-nine{position:relative}.sixteen-nine::before{display:block;content:"";width:100%;padding-top:56.25%}.sixteen-nine>*{position:absolute;top:0;left:0;right:0;bottom:0}.sr-only{display:none}.border{border:1px solid var(--border-color)}hy-push-state a,.a{position:relative;padding-bottom:.15rem;border-bottom:1px solid}hy-push-state a.no-hover,.a.no-hover{border-bottom:none;padding-bottom:0}.content .img{overflow:hidden}.content .img img{margin:0;width:100%;height:100%;background-color:var(--gray-bg)}hy-drawer{width:100%;position:relative;overflow:hidden}@media screen and (min-width: 64em){hy-drawer{position:fixed;width:21rem;top:0;left:0;bottom:0;margin-left:0}hy-drawer.cover{position:relative;width:100%}}@media screen and (min-width: 1666px){hy-drawer{width:calc(50% - 28rem)}}.sidebar{position:relative;display:flex;justify-content:center;align-items:center;color:rgba(255,255,255,0.75);text-align:center;z-index:2;min-height:100vh}.sidebar a{color:#fff;border-bottom-color:rgba(255,255,255,0.2)}.sidebar-bg{position:absolute;top:0;left:calc(50% - 50vw);width:100vw;height:100%;background:#202020 center / cover}.sidebar-bg::after{content:"";position:absolute;top:0;left:0;bottom:0;right:0;background:rgba(0,0,0,0.05)}.sidebar-bg.sidebar-overlay::after{background:linear-gradient(to bottom, rgba(32,32,32,0) 0%, rgba(32,32,32,0.5) 50%, rgba(32,32,32,0) 100%)}.sidebar-sticky{position:relative;z-index:3;max-width:21rem;padding:1.5rem;contain:content}.sidebar-about .avatar{margin-bottom:1.5rem}.sidebar-about>h2{margin-top:0}.sidebar-nav>ul{list-style:none;padding-left:0}a.sidebar-nav-item{display:inline-block;font-weight:var(--font-weight-heading);line-height:1.75;padding:.25rem;border-bottom:1px solid rgba(255,255,255,0.2)}.sidebar-social>ul{display:inline-block;list-style:none;padding-left:0;margin-bottom:0}.sidebar-social>ul>li{float:left}.sidebar-social>ul>li>a{display:inline-block;text-align:center;font-size:1.4rem;width:3rem;height:4rem;padding:.5rem 0;line-height:3rem}.sidebar-social>ul li+li{margin-top:0}.fixed-common,.fixed-top,.fixed-bottom{position:fixed;left:0;width:100%;z-index:2}.fixed-top{top:0}.fixed-bottom{bottom:0}.navbar>.content{padding-top:0;padding-bottom:0;min-height:0;color:var(--menu-text)}.nav-btn-bar{margin:0 -1rem 0 -.875rem}.nav-btn{background:none;border:none;padding:1.75rem .875rem;color:var(--menu-text) !important;cursor:pointer}.animation-main{opacity:0;pointer-events:none}.content{position:relative;margin-left:auto;margin-right:auto;padding:6rem 1rem 12rem}@media screen{.content{padding-left:1.5rem;max-width:38rem;min-height:100vh}}@media screen and (min-width: 54em){.content{max-width:42rem}}@media screen and (min-width: 64em){.content{padding-left:1rem;margin-left:24rem;margin-right:3rem}}@media screen and (min-width: 88em){.content{margin-left:25rem;margin-right:4rem;max-width:48rem}}@media screen and (min-width: 1666px){.content{margin:auto}}.avatar{width:6.5rem;height:6.5rem;border-radius:100%;overflow:hidden}@media screen and (min-width: 88em){.avatar{width:7rem;height:7rem}}.content .avatar{float:right;margin-left:.5rem}html{font-family:Noto Sans,Helvetica,Arial,sans-serif}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.heading{font-family:Roboto Slab,Helvetica,Arial,sans-serif}</style><link rel="preload" as="style" href="/assets/css/zerobone.css" id="_stylePreload"><link rel="preload" as="style" href="/assets/icomoon/style.css" id="_iconsPreload"><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Roboto+Slab:400|Noto+Sans:400,400i,700,700i&display=swap" id="_fontsPreload"> <script>setRel('_stylePreload');setRel('_iconsPreload');/**/setRel('_fontsPreload');/**/</script> <noscript><link rel="stylesheet" href="/assets/css/zerobone.css"><link rel="stylesheet" href="/assets/icomoon/style.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:400|Noto+Sans:400,400i,700,700i&display=swap"> </noscript><style id="_pageStyle"> .content a:not(.btn){color:#268bd2;border-color:rgba(38,139,210,0.2)}.content a:not(.btn):hover{border-color:#268bd2}:focus{outline-color:#268bd2 !important}.btn-primary{color:#fff;background-color:#268bd2;border-color:#268bd2}.btn-primary:focus,.btn-primary.focus,.form-control:focus,.form-control.focus{box-shadow:0 0 0 3px rgba(38,139,210,0.5)}.btn-primary:hover,.btn-primary.hover{color:#fff;background-color:#2076b2;border-color:#2076b2}.btn-primary:disabled,.btn-primary.disabled{color:#fff;background-color:#268bd2;border-color:#268bd2}.btn-primary:active,.btn-primary.active{color:#fff;background-color:#2076b2;border-color:#2076b2}::selection{color:#fff;background:#268bd2}::-moz-selection{color:#fff;background:#268bd2}</style><!--<![endif]--><body class="no-color-transition dark-mode"><div id="_navbar" class="navbar fixed-top"><div class="content"><div class="nav-btn-bar"> <span class="sr-only">Jump to:</span> <a id="_menu" class="nav-btn no-hover fl" href="#_navigation"> <span class="sr-only">Navigation</span> <span class="icon-menu"></span> </a></div></div></div><hr class="sr-only" hidden /> <hy-push-state replace-ids="_main" link-selector="a[href]:not([href*='/assets/']):not(.external):not(.no-push-state)" duration="250" script-selector="script:not([type^='math/tex'])" prefetch ><main id="_main" class="content fade-in layout-post" role="main" data-color="rgb(38,139,210)" data-theme-color="rgb(25,55,71)" data-background="rgb(32,32,32)" ><article id="post-blog-cs-compressing-congruence-automata" class="page post mb6" role="article"><header><h1 class="post-title"> Efficient compression of congruence class automations</h1><p class="post-date heading"> <time datetime="2020-09-01T00:00:00+02:00">01 Sep 2020</time> in <a href="/blog/cs/" class="flip-title">Computer Science</a><div class="hr pb0"></div></header><p>As already discussed in the previous post, any radix-b number <code class="MathJax_Preview">n</code><script type="math/tex">n</script> with <code class="MathJax_Preview">n \bmod{m} \in E \subseteq Z</code><script type="math/tex">n \bmod{m} \in E \subseteq Z</script> can be accepted by finite automata in a digit-by-digit manner. However, the construction is not always optimal. The amount of states required is not always the amount of congruence classes. In this post we will examine when exactly the finite automata can be simplified by combining states. Reducing the amount of states will also help produce a much simpler regular expression, for example, with the Kleene construction.<h2 id="general-way-to-optimize-an-automation">General way to optimize an automation</h2><p>Of course, we can optimize the DFA with the well-known algorithm based on the Myhill-Nerode theorem. Unfortunately, even an optimized implementation is not efficient enough to do the optimization for large <code class="MathJax_Preview">m</code><script type="math/tex">m</script> and <code class="MathJax_Preview">b</code><script type="math/tex">b</script>, because the complexity of the algorithm expressed in these terms is <code class="MathJax_Preview">O(bm^2)</code><script type="math/tex">O(bm^2)</script>, as the algorithm needs to iterate over all <code class="MathJax_Preview">m^2</code><script type="math/tex">m^2</script> pairs of states and consider all the outgoing transitions (<code class="MathJax_Preview">b</code><script type="math/tex">b</script> in each state). With <a href="/projects/numpat/">this tool</a> we can run the algorithm and get the following results for <code class="MathJax_Preview">b = 10</code><script type="math/tex">b = 10</script> and <code class="MathJax_Preview">1 \le m \le 20</code><script type="math/tex">1 \le m \le 20</script>:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>m= 1 |Z|= 1  Z = [[0]]
m= 2 |Z|= 2  Z = [[0], [1]]
m= 3 |Z|= 3  Z = [[0], [1], [2]]
m= 4 |Z|= 3  Z = [[0], [3, 1], [2]]
m= 5 |Z|= 2  Z = [[0], [2, 1, 3, 4]]
m= 6 |Z|= 4  Z = [[0], [4, 1], [5, 2], [3]]
m= 7 |Z|= 7  Z = [[0], [1], [2], [3], [4], [5], [6]]
m= 8 |Z|= 5  Z = [[0], [5, 1], [6, 2], [7, 3], [4]]
m= 9 |Z|= 9  Z = [[0], [1], [2], [3], [4], [5], [6], [7], [8]]
m=10 |Z|= 2  Z = [[0], [5, 4, 3, 2, 7, 6, 9, 8, 1]]
m=11 |Z|=11  Z = [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10]]
m=12 |Z|= 7  Z = [[0], [7, 1], [8, 2], [9, 3], [10, 4], [11, 5], [6]]
m=13 |Z|=13  Z = [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12]]
m=14 |Z|= 8  Z = [[0], [8, 1], [9, 2], [10, 3], [11, 4], [12, 5], [13, 6], [7]]
m=15 |Z|= 4  Z = [[0], [13, 10, 7, 4, 1], [5, 2, 8, 11, 14], [9, 6, 12, 3]]
m=16 |Z|= 9  Z = [[0], [9, 1], [10, 2], [11, 3], [12, 4], [13, 5], [14, 6], [15, 7], [8]]
m=17 |Z|=17  Z = [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16]]
m=18 |Z|=10  Z = [[0], [10, 1], [11, 2], [12, 3], [13, 4], [14, 5], [15, 6], [16, 7], [17, 8], [9]]
m=19 |Z|=19  Z = [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18]]
m=20 |Z|= 3  Z = [[0], [13, 11, 15, 17, 5, 3, 7, 9, 19, 1], [12, 10, 14, 16, 4, 2, 6, 8, 18]]
</code></pre></div></div><p>Here, <code class="MathJax_Preview">Z</code><script type="math/tex">Z</script> is the set of states in the new, minimal DFA. <code class="MathJax_Preview">Z</code><script type="math/tex">Z</script> is a set of equivalence classes that represent which states can be combined into one state. These equivalence classes have been computed for <code class="MathJax_Preview">E := \{0\}</code><script type="math/tex">E := \{0\}</script>. That is why, for example, for <code class="MathJax_Preview">m = 8</code><script type="math/tex">m = 8</script> states 0 and 4 aren’t in one equivalence class. They can’t be equivalent, because state 4 is intermediate while state 0 is final.<h2 id="computing-equivalence-classes-ahead-of-time">Computing equivalence classes ahead-of-time</h2><p>As you can see, there is clearly a pattern in the equivalence states above. For example, we can see that no states are equivalent when <code class="MathJax_Preview">m</code><script type="math/tex">m</script> is prime. By further examining the data above we can even conclude that the DFA probably can’t be simplified if <code class="MathJax_Preview">\gcd(b, m) = 1</code><script type="math/tex">\gcd(b, m) = 1</script> i.e. if <code class="MathJax_Preview">b</code><script type="math/tex">b</script> and <code class="MathJax_Preview">m</code><script type="math/tex">m</script> are coprime.<p>After formally examining when the states can be combined I came up with the following result:<h3 id="theorem">Theorem</h3><p>If <code class="MathJax_Preview">m \le b</code><script type="math/tex">m \le b</script> and <code class="MathJax_Preview">E \neq \varnothing</code><script type="math/tex">E \neq \varnothing</script>, then the minimum finite automation can be constructed as follows:<pre class="MathJax_Preview"><code>Z = \overset{\cdot}{\bigcup_{A\in Z'}} \{A \cap E, A \backslash E\}\backslash\varnothing</code></pre><script type="math/tex; mode=display">Z = \overset{\cdot}{\bigcup_{A\in Z'}} \{A \cap E, A \backslash E\}\backslash\varnothing</script><p>where <code class="MathJax_Preview">Z'</code><script type="math/tex">Z'</script> is the set of equivalence classes of the following equivalence relation:<pre class="MathJax_Preview"><code>x \sim y \Leftrightarrow x \equiv y \mod{\frac{m}{\gcd(b, m)}}</code></pre><script type="math/tex; mode=display">x \sim y \Leftrightarrow x \equiv y \mod{\frac{m}{\gcd(b, m)}}</script><h3 id="proof">Proof</h3><p>By definition of <code class="MathJax_Preview">\delta</code><script type="math/tex">\delta</script>, we know that:<pre class="MathJax_Preview"><code>\delta(r, d) = k \implies \delta(r, d + 1 \bmod b) = k + 1 \bmod m</code></pre><script type="math/tex; mode=display">\delta(r, d) = k \implies \delta(r, d + 1 \bmod b) = k + 1 \bmod m</script><p>Because <code class="MathJax_Preview">m \le b</code><script type="math/tex">m \le b</script>, it follows that the mapping <code class="MathJax_Preview">\delta(x, \Sigma)</code><script type="math/tex">\delta(x, \Sigma)</script> is surjective. In other words, <code class="MathJax_Preview">m \le b</code><script type="math/tex">m \le b</script> implies that every state has at least one transition to any other state. Any change to this mapping will shift it. As <code class="MathJax_Preview">E \neq \varnothing</code><script type="math/tex">E \neq \varnothing</script>, any shifted mapping <code class="MathJax_Preview">\delta'</code><script type="math/tex">\delta'</script> will lead to at least 1 digit <code class="MathJax_Preview">d</code><script type="math/tex">d</script> such that <code class="MathJax_Preview">\delta(x, d) \in E</code><script type="math/tex">\delta(x, d) \in E</script> and <code class="MathJax_Preview">\delta'(x, d) \notin E</code><script type="math/tex">\delta'(x, d) \notin E</script>.<p>Thus, 2 states <code class="MathJax_Preview">x,y \in Z</code><script type="math/tex">x,y \in Z</script> are equivalent if and only if they have equivalent mappings which is equivalent to:<pre class="MathJax_Preview"><code>\begin{aligned}
\delta(x, \Sigma) = \delta(y, \Sigma) &amp;\Leftrightarrow \delta(x, d) = \delta(y, d) \quad \forall d \in \Sigma \\
&amp;\Leftrightarrow xb + d \bmod m = yb + d \bmod m \\
&amp;\Leftrightarrow xb + d \equiv yb + d \mod{m} \\
&amp;\Leftrightarrow xb \equiv yb \mod{m} \\
&amp;\Leftrightarrow xb - yb \equiv 0 \mod{m} \\
&amp;\Leftrightarrow (x-y) \cdot b \equiv 0 \mod{m} \\
&amp;\Leftrightarrow x-y \equiv 0 \mod{\frac{m}{\gcd(b, m)}} \\
&amp;\Leftrightarrow x \equiv y \mod{\frac{m}{\gcd(b, m)}}
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} \delta(x, \Sigma) = \delta(y, \Sigma) &\Leftrightarrow \delta(x, d) = \delta(y, d) \quad \forall d \in \Sigma \\ &\Leftrightarrow xb + d \bmod m = yb + d \bmod m \\ &\Leftrightarrow xb + d \equiv yb + d \mod{m} \\ &\Leftrightarrow xb \equiv yb \mod{m} \\ &\Leftrightarrow xb - yb \equiv 0 \mod{m} \\ &\Leftrightarrow (x-y) \cdot b \equiv 0 \mod{m} \\ &\Leftrightarrow x-y \equiv 0 \mod{\frac{m}{\gcd(b, m)}} \\ &\Leftrightarrow x \equiv y \mod{\frac{m}{\gcd(b, m)}} \end{aligned} %]]></script><h3 id="first-corollary">First corollary</h3><p>It follows, that if <code class="MathJax_Preview">m \le b</code><script type="math/tex">m \le b</script>, <code class="MathJax_Preview">E \neq \varnothing</code><script type="math/tex">E \neq \varnothing</script> and <code class="MathJax_Preview">\gcd(b, m) = 1</code><script type="math/tex">\gcd(b, m) = 1</script>, then no states can be simplified and the minimal automation has <code class="MathJax_Preview">m</code><script type="math/tex">m</script> states.<h3 id="second-corollary">Second corollary</h3><p>If <code class="MathJax_Preview">m \le b</code><script type="math/tex">m \le b</script> and <code class="MathJax_Preview">E \neq \varnothing</code><script type="math/tex">E \neq \varnothing</script>, then the amount of states <code class="MathJax_Preview">Z'</code><script type="math/tex">Z'</script> (before splitting each equivalence class in final states and non final ones as shown in the theorem) is isomorph to the following set of orbits:<pre class="MathJax_Preview"><code>Z' \cong (\mathbb{Z}/m)/\langle \gcd(b, m) \rangle</code></pre><script type="math/tex; mode=display">Z' \cong (\mathbb{Z}/m)/\langle \gcd(b, m) \rangle</script><h3 id="example-implementation">Example implementation</h3><p>This Java method uses the results above to compute the equivalence classes efficiently:<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="nf">computeEquivalenceClasses</span><span class="o">(</span><span class="kt">int</span> <span class="n">b</span><span class="o">,</span> <span class="kt">int</span> <span class="n">m</span><span class="o">,</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">finalStates</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">assert</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="o">;</span>
    <span class="k">assert</span> <span class="o">!</span><span class="n">finalStates</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span>

    <span class="c1">// Union-Find datastructure, preferrably with union-by-rank and path compression</span>
    <span class="nc">UnionFind</span> <span class="n">equivalenceClasses</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UnionFind</span><span class="o">(</span><span class="n">m</span><span class="o">);</span>

    <span class="kt">int</span> <span class="n">bmgcd</span> <span class="o">=</span> <span class="nc">Euklidian</span><span class="o">.</span><span class="na">gcd</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">m</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">bmgcd</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">equivalenceClasses</span><span class="o">.</span><span class="na">getDisjointsSets</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kt">int</span> <span class="n">optimizedM</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="n">bmgcd</span><span class="o">;</span>

    <span class="c1">// loop through every set in the new set of equivalence classes</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">anchor</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">anchor</span> <span class="o">&lt;</span> <span class="n">optimizedM</span><span class="o">;</span> <span class="n">anchor</span><span class="o">++)</span> <span class="o">{</span>

        <span class="kt">int</span> <span class="n">current</span> <span class="o">=</span> <span class="n">anchor</span><span class="o">;</span> <span class="c1">// [anchor] is the equivalence class</span>
        <span class="c1">// oppositeAnchor is the element that is final if anchor is intermediate</span>
        <span class="c1">// and intermediate if anchor is final</span>
        <span class="c1">// if oppositeAnchor == anchor, then it is considered as not yet found</span>
        <span class="kt">int</span> <span class="n">oppositeAnchor</span> <span class="o">=</span> <span class="n">anchor</span><span class="o">;</span>

        <span class="kt">boolean</span> <span class="n">anchorFinal</span> <span class="o">=</span> <span class="n">finalStates</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">anchor</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(;;)</span> <span class="o">{</span>
            <span class="n">current</span> <span class="o">=</span> <span class="o">(</span><span class="n">current</span> <span class="o">+</span> <span class="n">optimizedM</span><span class="o">)</span> <span class="o">%</span> <span class="n">m</span><span class="o">;</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">current</span> <span class="o">==</span> <span class="n">anchor</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="kt">boolean</span> <span class="n">currentFinal</span> <span class="o">=</span> <span class="n">finalStates</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">current</span><span class="o">);</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">currentFinal</span> <span class="o">==</span> <span class="n">anchorFinal</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">equivalenceClasses</span><span class="o">.</span><span class="na">union</span><span class="o">(</span><span class="n">current</span><span class="o">,</span> <span class="n">anchor</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">oppositeAnchor</span> <span class="o">==</span> <span class="n">anchor</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// "initialize" oppositeAnchor</span>
                <span class="n">oppositeAnchor</span> <span class="o">=</span> <span class="n">current</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="n">equivalenceClasses</span><span class="o">.</span><span class="na">union</span><span class="o">(</span><span class="n">current</span><span class="o">,</span> <span class="n">oppositeAnchor</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="k">return</span> <span class="n">equivalenceClasses</span><span class="o">.</span><span class="na">getDisjointsSets</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div><p>If we use a union-find datastructure with <code class="highlighter-rouge">insert</code> in <code class="MathJax_Preview">O(1)</code><script type="math/tex">O(1)</script> (e.g. union-by-rank with path compression), then the complexity of the algorithm is <code class="MathJax_Preview">O(m)</code><script type="math/tex">O(m)</script> which is much better than <code class="MathJax_Preview">O(bm^2)</code><script type="math/tex">O(bm^2)</script>.<h3 id="case-when-m--b">Case when m &gt; b</h3><p>In case <code class="MathJax_Preview">m &gt; b</code><script type="math/tex">m > b</script> the equivalence relation depends very much on the set of final states <code class="MathJax_Preview">E</code><script type="math/tex">E</script>. With the Myhill Nerode theorem we get:<pre class="MathJax_Preview"><code>\begin{aligned}
x \sim y &amp;\Leftrightarrow (xc \in L \Leftrightarrow yc \in L \quad \forall c \in \Sigma^*) \\
&amp;\Leftrightarrow (x \cdot b^{|c|} + c \bmod m \in E \Leftrightarrow y \cdot b^{|c|} + c \bmod m \in E)
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} x \sim y &\Leftrightarrow (xc \in L \Leftrightarrow yc \in L \quad \forall c \in \Sigma^*) \\ &\Leftrightarrow (x \cdot b^{|c|} + c \bmod m \in E \Leftrightarrow y \cdot b^{|c|} + c \bmod m \in E) \end{aligned} %]]></script><h2 id="conclusion">Conclusion</h2><p>With the above theorem it is easy to implement a much faster algorithm that computes equivalent states. It also gives an intuition, why for example it is harder to test whether a decimal number is divisible by 9 than to test whether a decimal number is divisible by 5, if we measure “hardness” by the amount of states in the minimal DFA. It is the case because <code class="MathJax_Preview">\gcd(5, 10) = 5</code><script type="math/tex">\gcd(5, 10) = 5</script> and <code class="MathJax_Preview">\gcd(9, 10) = 1</code><script type="math/tex">\gcd(9, 10) = 1</script>.</article><hr class="dingbat related" /><aside class="about related mt4 mb4" role="complementary"><div class="author mt4"> <hy-img src="/assets/icons/logo_128.png" class="avatar" alt="Alexander Mayorov" srcset="/assets/icons/logo_128.png 1x,/assets/icons/logo_256.png 2x" root-margin="512px" > <noscript><img data-ignore src="/assets/icons/logo_128.png" class="avatar" alt="Alexander Mayorov" srcset="/assets/icons/logo_128.png 1x,/assets/icons/logo_256.png 2x" /></noscript> <span class="loading" slot="loading" hidden> <span class="icon-cog"></span> </span> </hy-img><h2 class="page-title hr"> About</h2><p>Computer Science student &amp; backend developer.<div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://github.com/ZeroBone" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a><li> <a href="mailto:zerobone21@gmail.com" title="Email" class="no-mark-external"> <span class="icon-mail"></span> <span class="sr-only">Email</span> </a><li> <a href="https://vk.com/alxmay" title="VK" class="no-mark-external"> <span class="icon-vk"></span> <span class="sr-only">VK</span> </a><li> <a href="https://www.linkedin.com/in/zerobone" title="LinkedIn" class="no-mark-external"> <span class="icon-linkedin2"></span> <span class="sr-only">LinkedIn</span> </a></ul></div></div></aside><aside class="related mb4" role="complementary"><h2 class="hr">Related Posts</h2><ul class="related-posts"><li> <a href="/blog/cs/2020-08-29-numbers-are-regular-languages/" class="h4 flip-title"><span>Numbers in congruence classes are regular languages</span></a> <time class="heading faded fine" datetime="2020-08-29T00:00:00+02:00">29 Aug 2020</time><li> <a href="/blog/cs/2020-02-21-non-recursive-extended-euklidian-algorithm/" class="h4 flip-title"><span>Extended Euclidean algorithm without stack or recursion</span></a> <time class="heading faded fine" datetime="2020-02-21T00:00:00+01:00">21 Feb 2020</time><li> <a href="/blog/cs/2019-06-30-call-stack-buffer-overflow/" class="h4 flip-title"><span>Call Stack - buffer overflow vulnerability</span></a> <time class="heading faded fine" datetime="2019-06-30T00:00:00+02:00">30 Jun 2019</time></ul></aside><aside class="related mb4" role="complementary"><h2 class="hr">Random Posts</h2><ul class="related-posts"><li> <a href="/blog/cs/2020-02-21-non-recursive-extended-euklidian-algorithm/" class="h4 flip-title"><span>Extended Euclidean algorithm without stack or recursion</span></a> <time class="heading faded fine" datetime="2020-02-21T00:00:00+01:00">21 Feb 2020</time><li> <a href="/blog/cs/2020-08-29-numbers-are-regular-languages/" class="h4 flip-title"><span>Numbers in congruence classes are regular languages</span></a> <time class="heading faded fine" datetime="2020-08-29T00:00:00+02:00">29 Aug 2020</time><li> <a href="/blog/cs/2019-06-30-call-stack-buffer-overflow/" class="h4 flip-title"><span>Call Stack - buffer overflow vulnerability</span></a> <time class="heading faded fine" datetime="2019-06-30T00:00:00+02:00">30 Jun 2019</time></ul></aside><footer role="contentinfo"><hr/><p><small class="copyright">Copyright © 2020 Alexander Mayorov. All rights reserved. </small><hr class="sr-only"/></footer></main><hy-drawer class="" align="left" threshold="10" touch-events prevent-default ><header id="_sidebar" class="sidebar" role="banner"><div class="sidebar-bg " style="background:rgb(32,32,32)"></div><div class="sidebar-sticky"><div class="sidebar-about"> <a class="no-hover" href="/" tabindex="-1"> <img src="/assets/icons/icon.png" class="avatar" alt="ZeroBone" data-ignore /> </a><h2 class="h1"><a href="/">ZeroBone</a></h2><p class=""> Computer Science student &amp; backend developer.</div><nav class="sidebar-nav heading" role="navigation"> <span class="sr-only">Navigation:</span><ul><li> <a id="_navigation" href="/blog/" class="sidebar-nav-item active" > Blog </a><li> <a href="/projects/" class="sidebar-nav-item" > Projects </a><li> <a href="/resume/" class="sidebar-nav-item" > Resume </a></ul></nav><div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://github.com/ZeroBone" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a><li> <a href="mailto:zerobone21@gmail.com" title="Email" class="no-mark-external"> <span class="icon-mail"></span> <span class="sr-only">Email</span> </a><li> <a href="https://vk.com/alxmay" title="VK" class="no-mark-external"> <span class="icon-vk"></span> <span class="sr-only">VK</span> </a><li> <a href="https://www.linkedin.com/in/zerobone" title="LinkedIn" class="no-mark-external"> <span class="icon-linkedin2"></span> <span class="sr-only">LinkedIn</span> </a></ul></div></div></header></hy-drawer><hr class="sr-only" hidden /> </hy-push-state> <!--[if gt IE 10]><!----> <script nomodule>!function(){var e=document.createElement("script");if(!("noModule"in e)&&"onbeforeload"in e){var t=!1;document.addEventListener("beforeload",function(n){if(n.target===e)t=!0;else if(!n.target.hasAttribute("nomodule")||!t)return;n.preventDefault()},!0),e.type="module",e.src=".",document.head.appendChild(e),e.remove()}}(); </script> <script type="module" src="/assets/js/zerobone-v.js"></script> <script nomodule src="/assets/js/zerobone-legacy-v.js" defer></script> <script type="module"> if ('serviceWorker' in navigator) { /**/ navigator.serviceWorker.getRegistration() .then(r => r.unregister()) .catch(() => {}); /**/ } </script> <!--<![endif]--><h2 class="sr-only" hidden>Templates (for web app):</h2><template id="_animation-template" hidden><div class="animation-main fixed-top"><div class="content"><div class="page"></div></div></div></template> <template id="_loading-template" hidden><div class="loading nav-btn fr"> <span class="sr-only">Loading…</span> <span class="icon-cog"></span></div></template> <template id="_error-template" hidden><div class="page"><h1 class="page-title">Error</h1><p class="lead"> An error occurred while loading <a class="this-link" href=""></a>.</div></template> <template id="_forward-template" hidden> <button id="_forward" class="forward nav-btn no-hover fl"> <span class="sr-only">Forward</span> <span class="icon-arrow-right2"></span> </button> </template> <template id="_back-template" hidden> <button id="_back" class="back nav-btn no-hover fl"> <span class="sr-only">Back</span> <span class="icon-arrow-left2"></span> </button> </template> <template id="_permalink-template" hidden> <a href="#" class="permalink"> <span class="sr-only">Permalink</span> <span class="icon-link"></span> </a> </template> <template id="_dark-mode-template" hidden> <button id="_dark-mode" class="nav-btn no-hover fl" > <span class="sr-only">Dark Mode</span> <span class="icon-contrast"></span> </button> </template></html>
