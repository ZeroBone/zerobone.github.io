<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>Extended Euclidean algorithm without stack or recursion | ZeroBone</title><meta name="generator" content="Jekyll v3.8.6" /><meta property="og:title" content="Extended Euclidean algorithm without stack or recursion" /><meta name="author" content="Alexander Mayorov" /><meta property="og:locale" content="en" /><meta name="description" content="Typical implementation of the extended Euclidean algorithm on the internet will just iteratively calculate modulo until 0 is reached. However, sometimes you also need to calculate the linear combination coefficients for the greatest common divisor." /><meta property="og:description" content="Typical implementation of the extended Euclidean algorithm on the internet will just iteratively calculate modulo until 0 is reached. However, sometimes you also need to calculate the linear combination coefficients for the greatest common divisor." /><link rel="canonical" href="https://zerobone.net/blog/cs/2020-02-21-non-recursive-extended-euklidian-algorithm/" /><meta property="og:url" content="https://zerobone.net/blog/cs/2020-02-21-non-recursive-extended-euklidian-algorithm/" /><meta property="og:site_name" content="ZeroBone" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-02-21T00:00:00+01:00" /> <script type="application/ld+json"> {"url":"https://zerobone.net/blog/cs/2020-02-21-non-recursive-extended-euklidian-algorithm/","headline":"Extended Euclidean algorithm without stack or recursion","dateModified":"2020-02-21T00:00:00+01:00","datePublished":"2020-02-21T00:00:00+01:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://zerobone.net/assets/icons/icon.png"},"name":"Alexander Mayorov"},"author":{"@type":"Person","name":"Alexander Mayorov"},"description":"Typical implementation of the extended Euclidean algorithm on the internet will just iteratively calculate modulo until 0 is reached. However, sometimes you also need to calculate the linear combination coefficients for the greatest common divisor.","mainEntityOfPage":{"@type":"WebPage","@id":"https://zerobone.net/blog/cs/2020-02-21-non-recursive-extended-euklidian-algorithm/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><meta name="keywords" content="ZeroBone,Programming,Computer Science,Alexander,Mayorov,Math"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="ZeroBone"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="application-name" content="ZeroBone"><meta name="msapplication-config" content="/assets/ieconfig.xml"><meta name="theme-color" content="rgb(10,41,132)"><meta name="generator" content="ZeroBone" /><link type="application/atom+xml" rel="alternate" href="https://zerobone.net/feed.xml" title="ZeroBone" /><link rel="alternate" href="https://zerobone.net/blog/cs/2020-02-21-non-recursive-extended-euklidian-algorithm/" hreflang="en"><link rel="shortcut icon" href="/assets/icons/favicon.ico"><link rel="apple-touch-icon" href="/assets/icons/icon.png"><link rel="manifest" href="/assets/manifest.json"><link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="dns-prefetch" href="/" id="_baseURL"><link rel="dns-prefetch" href="/sw.js" id="_hrefSW"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.js" id="_hrefKatexJS"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css" id="_hrefKatexCSS"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/contrib/copy-tex.min.js" id="_hrefKatexCopyJS"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/contrib/copy-tex.min.css" id="_hrefKatexCopyCSS"><link rel="dns-prefetch" href="/assets/img/swipe.svg" id="_hrefSwipeSVG"> <script> !function(e,t){"use strict";function n(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}e.loadJS=function(e,o){var r=t.createElement("script");r.src=e,o&&n(r,"load",o,{once:!0});var a=t.scripts[0];return a.parentNode.insertBefore(r,a),r},e._loaded=!1,e.loadJSDeferred=function(o,r){function a(){e._loaded=!0,r&&n(c,"load",r,{once:!0});var o=t.scripts[0];o.parentNode.insertBefore(c,o)}var c=t.createElement("script");return c.src=o,e._loaded?a():n(e,"load",a,{once:!0}),c},e.setRel=e.setRelStylesheet=function(e){function o(){this.rel="stylesheet"}n(t.getElementById(e),"load",o,{once:!0})}}(window,document); ; !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); ; !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); ; !function(w, d) { w._noPushState = false; w._noDrawer = false; }(window, document); </script> <!--[if gt IE 8]><!----><style> body{--code-font-family: Menlo,Monaco,Consolas,monospace;--font-weight: 400;--font-weight-bold: 700;--font-weight-heading: 400;--text-muted: #888;--gray-bg: rgba(0,0,0,0.025);--gray-text: #666;--menu-text: #bbb;--body-color: #333;--body-bg: #fff;--border-color: #ebebeb}.clearfix,.sidebar-social::after{content:"";display:table;clear:both}.color-transition,body,p,hr,.hr,table:not(.highlight) td,table:not(.highlight) th,.message{transition:background-color 1s ease, border-color 1s ease}.no-color-transition{transition:none !important}@media screen{body.light-mode{--text-muted: #888;--gray-bg: rgba(0,0,0,0.025);--gray-text: #666;--menu-text: #bbb;--body-color: #333;--body-bg: #fff;--border-color: #ebebeb}body.dark-mode{--text-muted: rgba(255,255,255,.5);--gray-bg: rgba(255,255,255,.033);--gray-text: rgba(255,255,255,.625);--menu-text: rgba(255,255,255,.25);--body-color: #ccc;--body-bg: #2d3039;--border-color: #3d424f}}*{box-sizing:border-box}html,body{margin:0;padding:0}html{font-size:16px;line-height:1.75}body{color:var(--body-color);background-color:var(--body-bg);font-weight:var(--font-weight);overflow-y:scroll}a{text-decoration:none}.lead{margin-left:-1rem;margin-right:-1rem}.content img,.img,.content video,.video{max-width:100%}.content img.lead,.img.lead,.content video.lead,.video.lead{max-width:calc(100% + 2rem);width:calc(100% + 2rem)}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{font-weight:var(--font-weight-heading);margin:5rem 0 1rem}h1,.h1{font-size:2rem;line-height:1.3}h2,.h2{font-size:1.5rem;line-height:1.4}h3,.h3{font-size:1.17em;line-height:1.5}h4,h5,h6,.h4,.h5,.h6{font-size:1rem;margin-bottom:0.5rem}p{margin-top:0;margin-bottom:1rem}p.lead{font-size:1.2em;margin-top:1.5rem;margin-bottom:1.5rem;padding:0 1rem}ul,ol,dl{margin-top:0;margin-bottom:1rem}ul,ol{padding-left:1.25rem}hr{position:relative;margin:3rem 0;border:0;border-top:1px solid var(--border-color)}.hr{border-bottom:1px solid var(--border-color);padding-bottom:1rem;margin-bottom:2rem}table:not(.highlight){border-collapse:collapse;margin-bottom:2rem;margin-left:-1rem}table:not(.highlight) td,table:not(.highlight) th{padding:.25rem .5rem;border:1px solid var(--border-color)}table:not(.highlight) td:first-child,table:not(.highlight) th:first-child{padding-left:1rem}table:not(.highlight) td:last-child,table:not(.highlight) th:last-child{padding-right:1rem}.page{margin-bottom:3em}.page li+li{margin-top:.25rem}.page>header{margin-bottom:2rem}.page-title,.post-title{margin-top:0}.post-date{display:block;margin-top:-0.5rem;margin-bottom:1rem;color:var(--text-muted)}.related-posts{padding-left:0;list-style:none;margin-bottom:2rem}.related-posts>li,.related-posts>li+li{margin-top:1rem}.message{margin-bottom:1rem;padding:1rem;color:var(--gray-text);background-color:var(--gray-bg);margin-left:-1rem;margin-right:-1rem}@media screen{body::before{content:'';width:.5rem;background:var(--border-color);position:fixed;left:0;top:0;bottom:0}}@media screen and (min-width: 64em){body::before{width:21rem}}@media screen and (min-width: 1666px){body::before{width:calc(50% - 28rem)}}@media screen and (min-width: 42em){html{font-size:17px}}@media screen and (min-width: 124em){html{font-size:18px}}.fade-in{animation-duration:500ms;animation-timing-function:ease;animation-name:fade-in;animation-fill-mode:forwards}@keyframes fade-in{from{transform:translateY(-3rem);opacity:0}50%{transform:translateY(-3rem);opacity:0}to{transform:translateY(0);opacity:1}}.fl{float:left}.fr{float:right}.mb4{margin-bottom:4rem}.mb6{margin-bottom:6rem}.mt0{margin-top:0}.mt2{margin-top:2rem}.mt3{margin-top:3rem}.mt4{margin-top:4rem}.pb0{padding-bottom:0}.sixteen-nine{position:relative}.sixteen-nine::before{display:block;content:"";width:100%;padding-top:56.25%}.sixteen-nine>*{position:absolute;top:0;left:0;right:0;bottom:0}.sr-only{display:none}.border{border:1px solid var(--border-color)}hy-push-state a,.a{position:relative;padding-bottom:.15rem;border-bottom:1px solid}hy-push-state a.no-hover,.a.no-hover{border-bottom:none;padding-bottom:0}.content .img{overflow:hidden}.content .img img{margin:0;width:100%;height:100%;background-color:var(--gray-bg)}hy-drawer{width:100%;position:relative;overflow:hidden}@media screen and (min-width: 64em){hy-drawer{position:fixed;width:21rem;top:0;left:0;bottom:0;margin-left:0}hy-drawer.cover{position:relative;width:100%}}@media screen and (min-width: 1666px){hy-drawer{width:calc(50% - 28rem)}}.sidebar{position:relative;display:flex;justify-content:center;align-items:center;color:rgba(255,255,255,0.75);text-align:center;z-index:2;min-height:100vh}.sidebar a{color:#fff;border-bottom-color:rgba(255,255,255,0.2)}.sidebar-bg{position:absolute;top:0;left:calc(50% - 50vw);width:100vw;height:100%;background:#202020 center / cover}.sidebar-bg::after{content:"";position:absolute;top:0;left:0;bottom:0;right:0;background:rgba(0,0,0,0.05)}.sidebar-bg.sidebar-overlay::after{background:linear-gradient(to bottom, rgba(32,32,32,0) 0%, rgba(32,32,32,0.5) 50%, rgba(32,32,32,0) 100%)}.sidebar-sticky{position:relative;z-index:3;max-width:21rem;padding:1.5rem;contain:content}.sidebar-about .avatar{margin-bottom:1.5rem}.sidebar-about>h2{margin-top:0}.sidebar-nav>ul{list-style:none;padding-left:0}a.sidebar-nav-item{display:inline-block;font-weight:var(--font-weight-heading);line-height:1.75;padding:.25rem;border-bottom:1px solid rgba(255,255,255,0.2)}.sidebar-social>ul{display:inline-block;list-style:none;padding-left:0;margin-bottom:0}.sidebar-social>ul>li{float:left}.sidebar-social>ul>li>a{display:inline-block;text-align:center;font-size:1.4rem;width:3rem;height:4rem;padding:.5rem 0;line-height:3rem}.sidebar-social>ul li+li{margin-top:0}.fixed-common,.fixed-top,.fixed-bottom{position:fixed;left:0;width:100%;z-index:2}.fixed-top{top:0}.fixed-bottom{bottom:0}.navbar>.content{padding-top:0;padding-bottom:0;min-height:0;color:var(--menu-text)}.nav-btn-bar{margin:0 -1rem 0 -.875rem}.nav-btn{background:none;border:none;padding:1.75rem .875rem;color:var(--menu-text) !important;cursor:pointer}.animation-main{opacity:0;pointer-events:none}.content{position:relative;margin-left:auto;margin-right:auto;padding:6rem 1rem 12rem}@media screen{.content{padding-left:1.5rem;max-width:38rem;min-height:100vh}}@media screen and (min-width: 54em){.content{max-width:42rem}}@media screen and (min-width: 64em){.content{padding-left:1rem;margin-left:24rem;margin-right:3rem}}@media screen and (min-width: 88em){.content{margin-left:25rem;margin-right:4rem;max-width:48rem}}@media screen and (min-width: 1666px){.content{margin:auto}}.avatar{width:6.5rem;height:6.5rem;border-radius:100%;overflow:hidden}@media screen and (min-width: 88em){.avatar{width:7rem;height:7rem}}.content .avatar{float:right;margin-left:.5rem}html{font-family:Noto Sans,Helvetica,Arial,sans-serif}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.heading{font-family:Roboto Slab,Helvetica,Arial,sans-serif}</style><link rel="preload" as="style" href="/assets/css/zerobone.css" id="_stylePreload"><link rel="preload" as="style" href="/assets/icomoon/style.css" id="_iconsPreload"><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Roboto+Slab:400|Noto+Sans:400,400i,700,700i&display=swap" id="_fontsPreload"> <script>setRel('_stylePreload');setRel('_iconsPreload');/**/setRel('_fontsPreload');/**/</script> <noscript><link rel="stylesheet" href="/assets/css/zerobone.css"><link rel="stylesheet" href="/assets/icomoon/style.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:400|Noto+Sans:400,400i,700,700i&display=swap"> </noscript><style id="_pageStyle"> .content a:not(.btn){color:#50b2b9;border-color:rgba(80,178,185,0.2)}.content a:not(.btn):hover{border-color:#50b2b9}:focus{outline-color:#50b2b9 !important}.btn-primary{color:#fff;background-color:#50b2b9;border-color:#50b2b9}.btn-primary:focus,.btn-primary.focus,.form-control:focus,.form-control.focus{box-shadow:0 0 0 3px rgba(80,178,185,0.5)}.btn-primary:hover,.btn-primary.hover{color:#fff;background-color:#419ba2;border-color:#419ba2}.btn-primary:disabled,.btn-primary.disabled{color:#fff;background-color:#50b2b9;border-color:#50b2b9}.btn-primary:active,.btn-primary.active{color:#fff;background-color:#419ba2;border-color:#419ba2}::selection{color:#fff;background:#50b2b9}::-moz-selection{color:#fff;background:#50b2b9}</style><!--<![endif]--><body class="no-color-transition dark-mode"><div id="_navbar" class="navbar fixed-top"><div class="content"><div class="nav-btn-bar"> <span class="sr-only">Jump to:</span> <a id="_menu" class="nav-btn no-hover fl" href="#_navigation"> <span class="sr-only">Navigation</span> <span class="icon-menu"></span> </a></div></div></div><hr class="sr-only" hidden /> <hy-push-state replace-ids="_main" link-selector="a[href]:not([href*='/assets/']):not(.external):not(.no-push-state)" duration="250" script-selector="script:not([type^='math/tex'])" prefetch ><main id="_main" class="content fade-in layout-post" role="main" data-color="rgb(80,178,185)" data-theme-color="rgb(10,41,132)" data-background="rgb(10,41,132)" ><article id="post-blog-cs-non-recursive-extended-euklidian-algorithm" class="page post mb6" role="article"><header><h1 class="post-title"> Extended Euclidean algorithm without stack or recursion</h1><p class="post-date heading"> <time datetime="2020-02-21T00:00:00+01:00">21 Feb 2020</time> in <a href="/blog/cs/" class="flip-title">Computer Science</a><div class="hr pb0"></div></header><p>Typical implementation of the extended Euclidean algorithm on the internet will just iteratively calculate modulo until 0 is reached. However, sometimes you also need to calculate the linear combination coefficients for the greatest common divisor.<h2 id="extended-euclidean-algorithm">Extended Euclidean algorithm</h2><p>The extended Euclidean algorithm allows us not only to calculate the gcd (greatest common divisor) of 2 numbers, but gives us also a representation of the result in a form of a linear combination:<pre class="MathJax_Preview"><code>\gcd(a, b) = u \cdot a + v \cdot b \quad u,v \in \mathbb{Z}</code></pre><script type="math/tex; mode=display">\gcd(a, b) = u \cdot a + v \cdot b \quad u,v \in \mathbb{Z}</script><p>gcd of more than 2 numbers can always be done by iteratively calculating the gcd of 2 numbers.<p>For example, let us calculate <code class="MathJax_Preview">gcd(14, 5)</code><script type="math/tex">gcd(14, 5)</script>:<pre class="MathJax_Preview"><code>\begin{aligned}
14 &amp;= 5 \cdot 2 + 4 \\
5 &amp;= 4 \cdot 1 + 1 \\
4 &amp;= 1 \cdot 4 + 0
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} 14 &= 5 \cdot 2 + 4 \\ 5 &= 4 \cdot 1 + 1 \\ 4 &= 1 \cdot 4 + 0 \end{aligned} %]]></script><p>So the greatest common divisor of <code class="MathJax_Preview">14</code><script type="math/tex">14</script> and <code class="MathJax_Preview">5</code><script type="math/tex">5</script> is <code class="MathJax_Preview">1</code><script type="math/tex">1</script>.<p>We can find the linear combination coefficients by writing <code class="MathJax_Preview">1</code><script type="math/tex">1</script> in terms of <code class="MathJax_Preview">14</code><script type="math/tex">14</script> and <code class="MathJax_Preview">5</code><script type="math/tex">5</script>:<pre class="MathJax_Preview"><code>\begin{aligned}
1 &amp;= 5 - 4 \cdot 1 \\
&amp;= 5 - (14 - 5 \cdot 2) \cdot 1 \\
&amp;= 5 - 14 + 5 \cdot 2 \\
&amp;= 3 \cdot 5 + (-1) \cdot 14
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} 1 &= 5 - 4 \cdot 1 \\ &= 5 - (14 - 5 \cdot 2) \cdot 1 \\ &= 5 - 14 + 5 \cdot 2 \\ &= 3 \cdot 5 + (-1) \cdot 14 \end{aligned} %]]></script><p>So in this case <code class="MathJax_Preview">u = 3</code><script type="math/tex">u = 3</script> and <code class="MathJax_Preview">v = -1</code><script type="math/tex">v = -1</script>:<pre class="MathJax_Preview"><code>\gcd(14, 5) = (-1) \cdot 14 + 3 \cdot 5 = 1</code></pre><script type="math/tex; mode=display">\gcd(14, 5) = (-1) \cdot 14 + 3 \cdot 5 = 1</script><p>We can calculate the linear combination coefficients by doing back substitution. But it is not so easy to implement this without recursion, because the back substitution is done when we are climbing out of the recursive calls. We will implement the algorithm recursively first.<h2 id="recursive-implementation">Recursive implementation</h2><p>The formula<pre class="MathJax_Preview"><code>\gcd(a, b) =
	\begin{cases}
	b, &amp; \text{if}\ a = 0 \\
	\gcd(b \bmod a, a), &amp; \text{otherwise}
	\end{cases}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \gcd(a, b) = \begin{cases} b, & \text{if}\ a = 0 \\ \gcd(b \bmod a, a), & \text{otherwise} \end{cases} %]]></script><p>allows us to describe the algorithm in a functional way:<ul><li>If <code class="MathJax_Preview">a = 0</code><script type="math/tex">a = 0</script>, then the greatest common divisor is <code class="MathJax_Preview">b</code><script type="math/tex">b</script>. Coefficients <code class="MathJax_Preview">u = 0</code><script type="math/tex">u = 0</script> and <code class="MathJax_Preview">v = 0</code><script type="math/tex">v = 0</script>.<li>Else, we make the problem simpler by calculating <code class="MathJax_Preview">\gcd(b \bmod a, a)</code><script type="math/tex">\gcd(b \bmod a, a)</script>. We can calculate the new coefficients based on the coefficients of the simpler problem.</ul><p>So, how can we calculate <code class="MathJax_Preview">u</code><script type="math/tex">u</script> and <code class="MathJax_Preview">v</code><script type="math/tex">v</script> so that<pre class="MathJax_Preview"><code>\gcd(a, b) = u \cdot a + v \cdot b</code></pre><script type="math/tex; mode=display">\gcd(a, b) = u \cdot a + v \cdot b</script><p>by knowing <code class="MathJax_Preview">u'</code><script type="math/tex">u'</script> and <code class="MathJax_Preview">v'</code><script type="math/tex">v'</script> with:<pre class="MathJax_Preview"><code>\gcd(b \bmod a, a) = u' \cdot (b \bmod a) + v' \cdot a</code></pre><script type="math/tex; mode=display">\gcd(b \bmod a, a) = u' \cdot (b \bmod a) + v' \cdot a</script><p>In order to do that we can write <code class="MathJax_Preview">b \bmod a</code><script type="math/tex">b \bmod a</script> in terms of initial <code class="MathJax_Preview">a</code><script type="math/tex">a</script> and <code class="MathJax_Preview">b</code><script type="math/tex">b</script>:<pre class="MathJax_Preview"><code>\begin{aligned}
	\gcd(b \bmod a, a)
    	&amp;= u' \cdot (b \bmod a) + v' \cdot a \\
    	&amp;= u' \cdot (b - \left\lfloor \frac{b}{a} \right\rfloor \cdot a) + v' \cdot a \\
    	&amp;= u' \cdot b - u' \cdot \left\lfloor \frac{b}{a} \right\rfloor \cdot a + v' \cdot a \\
    	&amp;= (v' - u' \cdot \left\lfloor \frac{b}{a} \right\rfloor) \cdot a + u' \cdot b
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} \gcd(b \bmod a, a) &= u' \cdot (b \bmod a) + v' \cdot a \\ &= u' \cdot (b - \left\lfloor \frac{b}{a} \right\rfloor \cdot a) + v' \cdot a \\ &= u' \cdot b - u' \cdot \left\lfloor \frac{b}{a} \right\rfloor \cdot a + v' \cdot a \\ &= (v' - u' \cdot \left\lfloor \frac{b}{a} \right\rfloor) \cdot a + u' \cdot b \end{aligned} %]]></script><p>So the new linear combination coefficients are:<pre class="MathJax_Preview"><code>\begin{aligned}
    u &amp;= v' - u' \cdot \left\lfloor \frac{b}{a} \right\rfloor \\
    v &amp;= u'
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} u &= v' - u' \cdot \left\lfloor \frac{b}{a} \right\rfloor \\ v &= u' \end{aligned} %]]></script><p>With this formula we are now ready to implement the algorithm:<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">GCD_Result</span><span class="p">:</span> <span class="c1"># Representation of the result
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gcd</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gcd</span> <span class="o">=</span> <span class="n">gcd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>

<span class="k">def</span> <span class="nf">extended_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">GCD_Result</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">extended_gcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">u</span> <span class="c1"># save u'
</span>    <span class="n">result</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">v</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">//</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">result</span><span class="o">.</span><span class="n">u</span> <span class="c1"># u = v' - u' * (b // a)
</span>    <span class="n">result</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">u</span> <span class="c1"># v = u'
</span>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div><h2 id="non-recursive-implementation">Non-recursive implementation</h2><p>The recursion in the algorithm above cannot be easily eliminated because the function is not tail-recursive.<p>In order to implement the algorithm with a loop we need to define a sequence of division remainders and then update the corresponding remainers as we calculate the remainders. Formally, we can define f finite sequence <code class="MathJax_Preview">r_n</code><script type="math/tex">r_n</script>:<pre class="MathJax_Preview"><code>\begin{aligned}
r_1 &amp;= a \\
r_2 &amp;= b \\
r_{n+2} &amp;= r_n \bmod r_{n+1}
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} r_1 &= a \\ r_2 &= b \\ r_{n+2} &= r_n \bmod r_{n+1} \end{aligned} %]]></script><p>If <code class="MathJax_Preview">r_{n+1} = 0</code><script type="math/tex">r_{n+1} = 0</script>, <code class="MathJax_Preview">r_{n+2}</code><script type="math/tex">r_{n+2}</script> is not defined. We can write each <code class="MathJax_Preview">r_n</code><script type="math/tex">r_n</script> as a linear combination of <code class="MathJax_Preview">u</code><script type="math/tex">u</script> and <code class="MathJax_Preview">v</code><script type="math/tex">v</script>. Now we are interested in how <code class="MathJax_Preview">u</code><script type="math/tex">u</script> and <code class="MathJax_Preview">v</code><script type="math/tex">v</script> change as we calculate remainders. To do this formally, we will need to define two new finite sequences <code class="MathJax_Preview">u_n</code><script type="math/tex">u_n</script> and <code class="MathJax_Preview">v_n</code><script type="math/tex">v_n</script> which will represent the linear combination coefficients:<pre class="MathJax_Preview"><code>r_n = u_n \cdot a + v_n \cdot b</code></pre><script type="math/tex; mode=display">r_n = u_n \cdot a + v_n \cdot b</script><p>By definition, <code class="MathJax_Preview">r_1 = a</code><script type="math/tex">r_1 = a</script> and <code class="MathJax_Preview">r_2 = b</code><script type="math/tex">r_2 = b</script>, so we can directly write the linear combination coefficients for <code class="MathJax_Preview">r_1</code><script type="math/tex">r_1</script> and <code class="MathJax_Preview">r_2</code><script type="math/tex">r_2</script>:<pre class="MathJax_Preview"><code>\begin{aligned}
    u_1 &amp;= 1 \\
    v_1 &amp;= 0 \\
    u_2 &amp;= 0 \\
    v_2 &amp;= 1
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} u_1 &= 1 \\ v_1 &= 0 \\ u_2 &= 0 \\ v_2 &= 1 \end{aligned} %]]></script><p>Let <code class="MathJax_Preview">q_n</code><script type="math/tex">q_n</script> be the finite sequence of integer divisions in <code class="MathJax_Preview">r_n</code><script type="math/tex">r_n</script>:<pre class="MathJax_Preview"><code>r_n = r_{n+1} \cdot q_{n+2} + r_{n+2}</code></pre><script type="math/tex; mode=display">r_n = r_{n+1} \cdot q_{n+2} + r_{n+2}</script><p>Now we can write <code class="MathJax_Preview">u_n</code><script type="math/tex">u_n</script> and <code class="MathJax_Preview">v_n</code><script type="math/tex">v_n</script> in terms of <code class="MathJax_Preview">q_n</code><script type="math/tex">q_n</script>:<pre class="MathJax_Preview"><code>\begin{aligned} 
    r_{n+2} &amp;= r_n - r_{n+1} \cdot q_{n+2} \\
    &amp;= u_n \cdot a + v_n \cdot b - r_{n+1} \cdot q_{n+2} \\
    &amp;= u_n \cdot a + v_n \cdot b - (u_{n+1} \cdot a + v_{n+1} \cdot b) \cdot q_{n+2} \\
    &amp;= u_n \cdot a + v_n \cdot b - u_{n+1} \cdot a \cdot q_{n+2} - v_{n+1} \cdot b \cdot q_{n+2} \\
    &amp;= (u_n - u_{n+1} \cdot q_{n+2}) \cdot a + (v_n - v_{n+1} \cdot q_{n+2}) \cdot b
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} r_{n+2} &= r_n - r_{n+1} \cdot q_{n+2} \\ &= u_n \cdot a + v_n \cdot b - r_{n+1} \cdot q_{n+2} \\ &= u_n \cdot a + v_n \cdot b - (u_{n+1} \cdot a + v_{n+1} \cdot b) \cdot q_{n+2} \\ &= u_n \cdot a + v_n \cdot b - u_{n+1} \cdot a \cdot q_{n+2} - v_{n+1} \cdot b \cdot q_{n+2} \\ &= (u_n - u_{n+1} \cdot q_{n+2}) \cdot a + (v_n - v_{n+1} \cdot q_{n+2}) \cdot b \end{aligned} %]]></script><p>To get the formula for <code class="MathJax_Preview">u_n</code><script type="math/tex">u_n</script> and <code class="MathJax_Preview">v_n</code><script type="math/tex">v_n</script> we can just substitute <code class="MathJax_Preview">n</code><script type="math/tex">n</script> instead of <code class="MathJax_Preview">n + 2</code><script type="math/tex">n + 2</script>:<pre class="MathJax_Preview"><code>\begin{aligned}
    u_n &amp;= u_{n-2} - q_n \cdot u_{n-1} \\
    v_n &amp;= v_{n-2} - q_n \cdot v_{n-1}
\end{aligned}</code></pre><script type="math/tex; mode=display">% <![CDATA[ \begin{aligned} u_n &= u_{n-2} - q_n \cdot u_{n-1} \\ v_n &= v_{n-2} - q_n \cdot v_{n-1} \end{aligned} %]]></script><p>With this formula and the initial values of the <code class="MathJax_Preview">u_n</code><script type="math/tex">u_n</script> and <code class="MathJax_Preview">v_n</code><script type="math/tex">v_n</script> sequences we can now implement the extended Euclidean algorithm without recursion:<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">extended_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># The algorithm will work correctly without this check
</span>        <span class="c1"># But it will take one iteration of the inner loop
</span>        <span class="k">return</span> <span class="n">GCD_Result</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">unPrev</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">vnPrev</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">unCur</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">vnCur</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">while</span> <span class="n">b</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Calculate new element of the qn sequence
</span>        <span class="n">qn</span> <span class="o">=</span> <span class="n">a</span> <span class="o">//</span> <span class="n">b</span>
        
        <span class="c1"># Calculate new element of the rn sequence
</span>        <span class="n">newRemainder</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">newRemainder</span>

        <span class="c1"># Calculate new coefficients with the formula above
</span>        <span class="n">unNew</span> <span class="o">=</span> <span class="n">unPrev</span> <span class="o">-</span> <span class="n">qn</span> <span class="o">*</span> <span class="n">unCur</span>
        <span class="n">vnNew</span> <span class="o">=</span> <span class="n">vnPrev</span> <span class="o">-</span> <span class="n">qn</span> <span class="o">*</span> <span class="n">vnCur</span>

        <span class="c1"># Shift coefficients
</span>        <span class="n">unPrev</span> <span class="o">=</span> <span class="n">unCur</span>
        <span class="n">vnPrev</span> <span class="o">=</span> <span class="n">vnCur</span>
        <span class="n">unCur</span> <span class="o">=</span> <span class="n">unNew</span>
        <span class="n">vnCur</span> <span class="o">=</span> <span class="n">vnNew</span>

    <span class="k">return</span> <span class="n">GCD_Result</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">unPrev</span><span class="p">,</span> <span class="n">vnPrev</span><span class="p">)</span>
</code></pre></div></div><h2 id="example">Example</h2><p>We can visualize the finite sequences we defined and see how the algorithm works with a table. We will calculate <code class="MathJax_Preview">\gcd(104, 47)</code><script type="math/tex">\gcd(104, 47)</script> and it’s linear combination coefficients:<pre class="MathJax_Preview"><code>\gcd(104, 47) = u \cdot 104 + v \cdot 47</code></pre><script type="math/tex; mode=display">\gcd(104, 47) = u \cdot 104 + v \cdot 47</script><table><thead><tr><th style="text-align: center"><code class="MathJax_Preview">r_n</code><script type="math/tex">r_n</script><th style="text-align: center"><code class="MathJax_Preview">q_n</code><script type="math/tex">q_n</script><th style="text-align: center"><code class="MathJax_Preview">u_n</code><script type="math/tex">u_n</script><th style="text-align: center"><code class="MathJax_Preview">v_n</code><script type="math/tex">v_n</script><tbody><tr><td style="text-align: center">104<td style="text-align: center">-<td style="text-align: center">1<td style="text-align: center">0<tr><td style="text-align: center">47<td style="text-align: center">-<td style="text-align: center">0<td style="text-align: center">1<tr><td style="text-align: center">10<td style="text-align: center">2<td style="text-align: center">1<td style="text-align: center">-2<tr><td style="text-align: center">7<td style="text-align: center">4<td style="text-align: center">-4<td style="text-align: center">9<tr><td style="text-align: center">3<td style="text-align: center">1<td style="text-align: center">5<td style="text-align: center">-11<tr><td style="text-align: center">1<td style="text-align: center">2<td style="text-align: center">-14<td style="text-align: center">31<tr><td style="text-align: center">0<td style="text-align: center">3<td style="text-align: center">33<td style="text-align: center">20</table><p>At each step we first calculate the next element from the <code class="MathJax_Preview">q_n</code><script type="math/tex">q_n</script> sequence and then use it to calculate new linear combination coefficients <code class="MathJax_Preview">u_n</code><script type="math/tex">u_n</script> and <code class="MathJax_Preview">v_n</code><script type="math/tex">v_n</script>.<p>The result of the algorithm:<pre class="MathJax_Preview"><code>\gcd(104, 47) = -14 \cdot 104 + 31 \cdot 47 = 1</code></pre><script type="math/tex; mode=display">\gcd(104, 47) = -14 \cdot 104 + 31 \cdot 47 = 1</script><h2 id="improvement-of-the-non-recusive-solution">Improvement of the non-recusive solution</h2><p>As we see in the example above, we don’t need to calculate the last row of the table because we aren’t interested in the linear combination that forms zero. We can terminate the algorithm directly after calculating the new element of the <code class="MathJax_Preview">r_n</code><script type="math/tex">r_n</script> sequence:<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">extended_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Optional check
</span>        <span class="k">return</span> <span class="n">GCD_Result</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Without this check the first iteration will divide by zero
</span>        <span class="k">return</span> <span class="n">GCD_Result</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">unPrev</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">vnPrev</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">unCur</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">vnCur</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">qn</span> <span class="o">=</span> <span class="n">a</span> <span class="o">//</span> <span class="n">b</span>
        <span class="n">newR</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">newR</span>

        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">GCD_Result</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">unCur</span><span class="p">,</span> <span class="n">vnCur</span><span class="p">)</span>

        <span class="c1"># Update coefficients
</span>        <span class="n">unNew</span> <span class="o">=</span> <span class="n">unPrev</span> <span class="o">-</span> <span class="n">qn</span> <span class="o">*</span> <span class="n">unCur</span>
        <span class="n">vnNew</span> <span class="o">=</span> <span class="n">vnPrev</span> <span class="o">-</span> <span class="n">qn</span> <span class="o">*</span> <span class="n">vnCur</span>

        <span class="c1"># Shift coefficients
</span>        <span class="n">unPrev</span> <span class="o">=</span> <span class="n">unCur</span>
        <span class="n">vnPrev</span> <span class="o">=</span> <span class="n">vnCur</span>
        <span class="n">unCur</span> <span class="o">=</span> <span class="n">unNew</span>
        <span class="n">vnCur</span> <span class="o">=</span> <span class="n">vnNew</span>
</code></pre></div></div></article><hr class="dingbat related" /><aside class="about related mt4 mb4" role="complementary"><div class="author mt4"> <hy-img src="/assets/icons/logo_128.png" class="avatar" alt="Alexander Mayorov" srcset="/assets/icons/logo_128.png 1x,/assets/icons/logo_256.png 2x" root-margin="512px" > <noscript><img data-ignore src="/assets/icons/logo_128.png" class="avatar" alt="Alexander Mayorov" srcset="/assets/icons/logo_128.png 1x,/assets/icons/logo_256.png 2x" /></noscript> <span class="loading" slot="loading" hidden> <span class="icon-cog"></span> </span> </hy-img><h2 class="page-title hr"> About</h2><p>Computer Science student &amp; backend developer.<div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://github.com/ZeroBone" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a><li> <a href="mailto:zerobone21@gmail.com" title="Email" class="no-mark-external"> <span class="icon-mail"></span> <span class="sr-only">Email</span> </a><li> <a href="https://vk.com/alxmay" title="VK" class="no-mark-external"> <span class="icon-vk"></span> <span class="sr-only">VK</span> </a><li> <a href="https://www.linkedin.com/in/zerobone" title="LinkedIn" class="no-mark-external"> <span class="icon-linkedin2"></span> <span class="sr-only">LinkedIn</span> </a></ul></div></div></aside><aside class="related mb4" role="complementary"><h2 class="hr">Related Posts</h2><ul class="related-posts"><li> <a href="/blog/cs/2020-09-01-compressing-congruence-automata/" class="h4 flip-title"><span>Efficient compression of congruence class automations</span></a> <time class="heading faded fine" datetime="2020-09-01T00:00:00+02:00">01 Sep 2020</time><li> <a href="/blog/cs/2020-08-29-numbers-are-regular-languages/" class="h4 flip-title"><span>Numbers in congruence classes are regular languages</span></a> <time class="heading faded fine" datetime="2020-08-29T00:00:00+02:00">29 Aug 2020</time><li> <a href="/blog/cs/2019-06-30-call-stack-buffer-overflow/" class="h4 flip-title"><span>Call Stack - buffer overflow vulnerability</span></a> <time class="heading faded fine" datetime="2019-06-30T00:00:00+02:00">30 Jun 2019</time></ul></aside><aside class="related mb4" role="complementary"><h2 class="hr">Random Posts</h2><ul class="related-posts"><li> <a href="/blog/cs/2020-08-29-numbers-are-regular-languages/" class="h4 flip-title"><span>Numbers in congruence classes are regular languages</span></a> <time class="heading faded fine" datetime="2020-08-29T00:00:00+02:00">29 Aug 2020</time><li> <a href="/blog/cs/2019-06-30-call-stack-buffer-overflow/" class="h4 flip-title"><span>Call Stack - buffer overflow vulnerability</span></a> <time class="heading faded fine" datetime="2019-06-30T00:00:00+02:00">30 Jun 2019</time><li> <a href="/blog/cs/2020-09-01-compressing-congruence-automata/" class="h4 flip-title"><span>Efficient compression of congruence class automations</span></a> <time class="heading faded fine" datetime="2020-09-01T00:00:00+02:00">01 Sep 2020</time></ul></aside><footer role="contentinfo"><hr/><p><small class="copyright">Copyright © 2020 Alexander Mayorov. All rights reserved. </small><hr class="sr-only"/></footer></main><hy-drawer class="" align="left" threshold="10" touch-events prevent-default ><header id="_sidebar" class="sidebar" role="banner"><div class="sidebar-bg " style="background:rgb(10,41,132)"></div><div class="sidebar-sticky"><div class="sidebar-about"> <a class="no-hover" href="/" tabindex="-1"> <img src="/assets/icons/icon.png" class="avatar" alt="ZeroBone" data-ignore /> </a><h2 class="h1"><a href="/">ZeroBone</a></h2><p class=""> Computer Science student &amp; backend developer.</div><nav class="sidebar-nav heading" role="navigation"> <span class="sr-only">Navigation:</span><ul><li> <a id="_navigation" href="/blog/" class="sidebar-nav-item active" > Blog </a><li> <a href="/projects/" class="sidebar-nav-item" > Projects </a><li> <a href="/resume/" class="sidebar-nav-item" > Resume </a></ul></nav><div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://github.com/ZeroBone" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a><li> <a href="mailto:zerobone21@gmail.com" title="Email" class="no-mark-external"> <span class="icon-mail"></span> <span class="sr-only">Email</span> </a><li> <a href="https://vk.com/alxmay" title="VK" class="no-mark-external"> <span class="icon-vk"></span> <span class="sr-only">VK</span> </a><li> <a href="https://www.linkedin.com/in/zerobone" title="LinkedIn" class="no-mark-external"> <span class="icon-linkedin2"></span> <span class="sr-only">LinkedIn</span> </a></ul></div></div></header></hy-drawer><hr class="sr-only" hidden /> </hy-push-state> <!--[if gt IE 10]><!----> <script nomodule>!function(){var e=document.createElement("script");if(!("noModule"in e)&&"onbeforeload"in e){var t=!1;document.addEventListener("beforeload",function(n){if(n.target===e)t=!0;else if(!n.target.hasAttribute("nomodule")||!t)return;n.preventDefault()},!0),e.type="module",e.src=".",document.head.appendChild(e),e.remove()}}(); </script> <script type="module" src="/assets/js/zerobone-v.js"></script> <script nomodule src="/assets/js/zerobone-legacy-v.js" defer></script> <script type="module"> if ('serviceWorker' in navigator) { /**/ navigator.serviceWorker.getRegistration() .then(r => r.unregister()) .catch(() => {}); /**/ } </script> <!--<![endif]--><h2 class="sr-only" hidden>Templates (for web app):</h2><template id="_animation-template" hidden><div class="animation-main fixed-top"><div class="content"><div class="page"></div></div></div></template> <template id="_loading-template" hidden><div class="loading nav-btn fr"> <span class="sr-only">Loading…</span> <span class="icon-cog"></span></div></template> <template id="_error-template" hidden><div class="page"><h1 class="page-title">Error</h1><p class="lead"> An error occurred while loading <a class="this-link" href=""></a>.</div></template> <template id="_forward-template" hidden> <button id="_forward" class="forward nav-btn no-hover fl"> <span class="sr-only">Forward</span> <span class="icon-arrow-right2"></span> </button> </template> <template id="_back-template" hidden> <button id="_back" class="back nav-btn no-hover fl"> <span class="sr-only">Back</span> <span class="icon-arrow-left2"></span> </button> </template> <template id="_permalink-template" hidden> <a href="#" class="permalink"> <span class="sr-only">Permalink</span> <span class="icon-link"></span> </a> </template> <template id="_dark-mode-template" hidden> <button id="_dark-mode" class="nav-btn no-hover fl" > <span class="sr-only">Dark Mode</span> <span class="icon-contrast"></span> </button> </template></html>
