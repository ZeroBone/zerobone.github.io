<!DOCTYPE html>
<html lang="en">







<head>
  






  
    
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>The Dining Philosophers problem and different ways of solving it | ZeroBone</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="The Dining Philosophers problem and different ways of solving it" />
<meta name="author" content="zerobone" />
<meta property="og:locale" content="en" />
<meta name="description" content="The dining philosophers problem is a well-known problem in computer science, originally formulated by Edsger Dijkstra to illustrate the possibility of deadlocks in programs where multiple threads lock and unlock multiple shared resources, such that a situation in which every thread is waiting for actions from other threads and no thread can thus continue it’s normal execution may occur. We will consider different approaches for solving this problem in the present post." />
<meta property="og:description" content="The dining philosophers problem is a well-known problem in computer science, originally formulated by Edsger Dijkstra to illustrate the possibility of deadlocks in programs where multiple threads lock and unlock multiple shared resources, such that a situation in which every thread is waiting for actions from other threads and no thread can thus continue it’s normal execution may occur. We will consider different approaches for solving this problem in the present post." />
<link rel="canonical" href="http://localhost:4000/blog/cs/dining-philosophers-problem/" />
<meta property="og:url" content="http://localhost:4000/blog/cs/dining-philosophers-problem/" />
<meta property="og:site_name" content="ZeroBone" />
<meta property="og:image" content="http://localhost:4000/assets/img/blog/dining-philosophers-tmb.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-24T00:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/blog/dining-philosophers-tmb.jpg" />
<meta property="twitter:title" content="The Dining Philosophers problem and different ways of solving it" />
<meta name="twitter:site" content="@ZeroBone21" />
<meta name="twitter:creator" content="@zerobone" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"zerobone"},"dateModified":"2021-03-14T00:00:00+01:00","datePublished":"2021-01-24T00:00:00+01:00","description":"The dining philosophers problem is a well-known problem in computer science, originally formulated by Edsger Dijkstra to illustrate the possibility of deadlocks in programs where multiple threads lock and unlock multiple shared resources, such that a situation in which every thread is waiting for actions from other threads and no thread can thus continue it’s normal execution may occur. We will consider different approaches for solving this problem in the present post.","headline":"The Dining Philosophers problem and different ways of solving it","image":{"srcset":{"1920w":"/assets/img/blog/dining-philosophers-tmb.jpg","960w":"/assets/img/blog/dining-philosophers-tmb@0,5x.jpg","480w":"/assets/img/blog/dining-philosophers-tmb@0,25x.jpg","240w":"/assets/img/blog/dining-philosophers-tmb@0,125x.jpg"},"url":"http://localhost:4000/assets/img/blog/dining-philosophers-tmb.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/cs/dining-philosophers-problem/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/icons/icon.png"},"name":"zerobone"},"url":"http://localhost:4000/blog/cs/dining-philosophers-problem/"}</script>
<!-- End Jekyll SEO tag -->


  

  
    <meta name="keywords" content="ZeroBone,Alexander,Mayorov,Computer Science,CS,Mathematics,Math">
  



  <meta name="theme-color" content="rgb(10,41,132)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="ZeroBone">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="ZeroBone">

<meta name="generator" content="Hydejack v9.1.6" />


<link rel="alternate" href="http://localhost:4000/blog/cs/dining-philosophers-problem/" hreflang="en">

<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="ZeroBone" />


<link rel="shortcut icon"    href="/assets/icons/favicon.ico">
<link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">

<link rel="manifest" href="/assets/site.webmanifest">

<link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com">


  <link rel="dns-prefetch" href="https://www.google-analytics.com">


<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">

<link rel="dns-prefetch" href="/assets/js/search-worker-9.1.6.js" as="worker" id="_hrefSearch">

  
  <link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css" id="_katexPreload">
  <noscript><link rel="stylesheet" href="/assets/bower_components/katex/dist/katex.min.css"></noscript>




<link rel="dns-prefetch" href="https://zerobone.disqus.com" id="_hrefDisqus">


<script>!function(r,c){"use strict";function a(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=c.createElement("script"),e=(n.src=e,t&&a(n,"load",t,{once:!0}),c.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=c.createElement("script");function o(){r._loaded=!0,t&&a(n,"load",t,{once:!0});var e=c.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():a(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){a(c.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}}(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = true;
  w._noToc = true;
  w._noSearch = false;
  w._advertise = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2022-09-05T00:44:00+02:00',
  };
  w._clapButton = true;
}(window);</script>



<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.1.6.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700%7CNoto+Sans:400,400i,700,700i&display=swap" id="_fontsPreload">



  <style id="_pageStyle">

html{--accent-color: rgb(80,178,185);--accent-color-faded: rgba(80,178,185,0.5);--accent-color-highlight: rgba(80,178,185,0.1);--accent-color-darkened: #419ba2;--theme-color: rgb(10,41,132);--dark-mode-body-bg: #282a31;--dark-mode-border-color: #333640}

</style>


<!--<![endif]-->


<!-- Add HTML tags here to be included in the head -->


</head>

<body class="no-toc no-break-layout no-large-headings no-third-column">
  


<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-post"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/">blog</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/cs/">cs</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>dining-philosophers-problem</span>
        
      </li>
    
  
</ul></nav>
  










<article id="post-blog-cs-dining-philosophers-problem" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        The Dining Philosophers problem and different ways of solving it
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2021-01-24T00:00:00+01:00">24.01.2021</time> in <a href="/blog/cs/" class="flip-title">Computer Science</a> &#8594; <a href="/tag/concurrency/" class="flip-title">Concurrent programming</a>
      </span>
      
        
          
          
          
            
            
            <span class="ellipsis" data-tippy-content="Last modified at: 14.03.2021">
              <span class="sr-only">Last modified at:</span>
              <span class="icon-history"></span>
              <time datetime="2021-03-14T00:00:00+01:00">14.03.2021</time>
            </span>
          
        
      
    </div>

    
    
      
        <div class="img-wrapper lead aspect-ratio sixteen-nine flip-project-img">
          


<img
  
    src="/assets/img/blog/dining-philosophers-tmb.jpg"
    srcset="/assets/img/blog/dining-philosophers-tmb.jpg 1920w,/assets/img/blog/dining-philosophers-tmb@0,5x.jpg 960w,/assets/img/blog/dining-philosophers-tmb@0,25x.jpg 480w,/assets/img/blog/dining-philosophers-tmb@0,125x.jpg 240w"
    
  
  alt="The Dining Philosophers problem and different ways of solving it"
  
  
  width="864"
  height="486"
  loading="lazy"
/>

        </div>
      
      
    

    



  


  </header>

  
    <p>The dining philosophers problem is a well-known problem in computer science, originally formulated by Edsger Dijkstra to illustrate the possibility of deadlocks in programs where multiple threads lock and unlock multiple shared resources, such that a situation in which every thread is waiting for actions from other threads and no thread can thus continue it’s normal execution may occur. We will consider different approaches for solving this problem in the present post.</p>

<h2 id="the-problem">The problem</h2>

<p>The dining philosophers problem has different formulations and variations. We will consider one classic definition:</p>

<ul>
  <li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> philosophers (philosophers <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0,1,\dots,n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>) are sitting at a round table.</li>
  <li>Each philosopher has a plate in front of him. Each plate has a fork to the left and to the right of it. However, if any 2 philosophers sit next to each other, they share 1 fork as illustrated below, for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">n = 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>.</li>
</ul>

<p><img src="/assets/img/blog/dining-philosophers.svg" alt="8 dining philosophers" loading="lazy" /></p>

<p>Each philosopher behaves independently from other philosophers, but in accordance with the following scenario:</p>

<ol>
  <li><em>Think</em> for some time.</li>
  <li><em>Take</em> the right fork.</li>
  <li><em>Take</em> the left fork.</li>
  <li><em>Eat</em> food.</li>
  <li><em>Put</em> the left fork back.</li>
  <li><em>Put</em> the right fork back.</li>
  <li><em>Repeat</em> the whole process again, i.e. go to step 1.</li>
</ol>

<p>If a philosopher wants to take a fork, but this fork is currently used by the neighbor, the philosopher waits until the neighbor puts the fork back before getting it. If two neighbors try to take one fork at the same time, only one of them succeeds and the other one waits.</p>

<p>From a programmer’s perspective, each philosopher is a thread performing these actions in an infinite loop.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// file: "Philosopher.java"</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Philosopher</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Fork</span> <span class="n">leftFork</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Fork</span> <span class="n">rightFork</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Philosopher</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="nc">Fork</span> <span class="n">leftFork</span><span class="o">,</span> <span class="nc">Fork</span> <span class="n">rightFork</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftFork</span> <span class="o">=</span> <span class="n">leftFork</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rightFork</span> <span class="o">=</span> <span class="n">rightFork</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(;;)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is thinking..."</span><span class="o">);</span>
            <span class="n">rightFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="n">leftFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is eating..."</span><span class="o">);</span>
            <span class="n">leftFork</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" has put down the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="n">rightFork</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" has put down the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>Forks are essentially resources shared under mutual exclusion. In computer science, such data structures are called <em>monitors</em>. In Java, they can be implemented easily with <code class="language-plaintext highlighter-rouge">synchronized</code> methods. As mentioned above, a fork can only be used by one philosopher at a time, so we can use the <code class="language-plaintext highlighter-rouge">wait()</code> method to wait in case the fork is not available, and <code class="language-plaintext highlighter-rouge">notify()</code> some waiting philosopher (thread) if the fork is not being used anymore:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// file: "Fork.java"</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Fork</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">forkIsOnTheTable</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">philosopherUsingThisFork</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Fork</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">take</span><span class="o">(</span><span class="kt">int</span> <span class="n">philosopher</span><span class="o">)</span> <span class="o">{</span>

        <span class="k">while</span> <span class="o">(!</span><span class="n">forkIsOnTheTable</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">wait</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">ignored</span><span class="o">)</span> <span class="o">{}</span>
        <span class="o">}</span>

        <span class="n">philosopherUsingThisFork</span> <span class="o">=</span> <span class="n">philosopher</span><span class="o">;</span>

        <span class="n">forkIsOnTheTable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">put</span><span class="o">(</span><span class="kt">int</span> <span class="n">philosopher</span><span class="o">)</span> <span class="o">{</span>

        <span class="k">if</span> <span class="o">(!</span><span class="n">forkIsOnTheTable</span> <span class="o">&amp;&amp;</span> <span class="n">philosopherUsingThisFork</span> <span class="o">==</span> <span class="n">philosopher</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">forkIsOnTheTable</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="n">notify</span><span class="o">();</span>
        <span class="o">}</span>

    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>Finally, the round table described and illustrated above can be simulated as follows:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// file: "DiningPhilosophers.java"</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DiningPhilosophers</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Philosopher</span><span class="o">[]</span> <span class="nf">createPhilosophers</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">Fork</span><span class="o">[]</span> <span class="n">forks</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Fork</span><span class="o">[</span><span class="n">n</span><span class="o">];</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">forks</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Fork</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nc">Philosopher</span><span class="o">[]</span> <span class="n">philosophers</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Philosopher</span><span class="o">[</span><span class="n">n</span><span class="o">];</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>

            <span class="nc">Fork</span> <span class="n">leftFork</span> <span class="o">=</span> <span class="n">forks</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
            <span class="nc">Fork</span> <span class="n">rightFork</span> <span class="o">=</span> <span class="n">forks</span><span class="o">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">%</span> <span class="n">n</span><span class="o">];</span>

            <span class="n">philosophers</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Philosopher</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">leftFork</span><span class="o">,</span> <span class="n">rightFork</span><span class="o">);</span>

        <span class="o">}</span>

        <span class="k">return</span> <span class="n">philosophers</span><span class="o">;</span>

    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">Philosopher</span><span class="o">[]</span> <span class="n">philosophers</span> <span class="o">=</span> <span class="n">createPhilosophers</span><span class="o">(</span><span class="mi">8</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="nc">Philosopher</span> <span class="n">philosopher</span> <span class="o">:</span> <span class="n">philosophers</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">philosopher</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>

    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>By running the listed program, we can observe different concurrent scenarios of philosophers thinking, competing for forks and eating. For example, I got the following output, after which the program neither terminated nor printed anything else:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Philosopher 0 is thinking...
Philosopher 1 is thinking...
Philosopher 2 is thinking...
Philosopher 3 is thinking...
Philosopher 0 took the right fork 1
Philosopher 0 took the left fork 0
Philosopher 0 is eating...
Philosopher 0 has put down the left fork 0
Philosopher 0 has put down the right fork 1
Philosopher 1 took the right fork 2
Philosopher 1 took the left fork 1
Philosopher 1 is eating...
Philosopher 1 has put down the left fork 1
Philosopher 1 has put down the right fork 2
Philosopher 1 is thinking...
Philosopher 0 is thinking...
Philosopher 2 took the right fork 3
Philosopher 4 is thinking...
Philosopher 5 is thinking...
Philosopher 3 took the right fork 4
Philosopher 1 took the right fork 2
Philosopher 0 took the right fork 1
Philosopher 0 took the left fork 0
Philosopher 0 is eating...
Philosopher 0 has put down the left fork 0
Philosopher 1 took the left fork 1
Philosopher 1 is eating...
Philosopher 1 has put down the left fork 1
Philosopher 1 has put down the right fork 2
Philosopher 1 is thinking...
Philosopher 2 took the left fork 2
Philosopher 2 is eating...
Philosopher 2 has put down the left fork 2
Philosopher 2 has put down the right fork 3
Philosopher 2 is thinking...
Philosopher 0 has put down the right fork 1
Philosopher 0 is thinking...
Philosopher 4 took the right fork 5
Philosopher 6 is thinking...
Philosopher 7 is thinking...
Philosopher 5 took the right fork 6
Philosopher 2 took the right fork 3
Philosopher 1 took the right fork 2
Philosopher 0 took the right fork 1
Philosopher 6 took the right fork 7
Philosopher 7 took the right fork 0
</code></pre></div></div>

<p>By reading this output upwards, we can see that the last thing each philosopher did was to take the right fork. After that, all philosophers need to take the left fork, so all of them wait for each other to return the right fork after eating, but no one can eat, so the program comes to a deadlock state.</p>

<p>By the way, in most cases if you run this program, it will probably hang after a lot more operations, but we can provoke a deadlock (the situation described above) by adding <code class="language-plaintext highlighter-rouge">Thread.yield()</code> before <code class="language-plaintext highlighter-rouge">leftFork.get(id);</code> in the <code class="language-plaintext highlighter-rouge">run()</code> method of the <code class="language-plaintext highlighter-rouge">Philosopher</code> class. This will recommend the JVM to reschedule threads after the current philosopher has taken only one fork.</p>

<p>The simplest possible scenario leading to a deadlock can be illustrated with the following diagram:</p>

<p><img src="/assets/img/blog/dining-philosophers-deadlock.svg" alt="Simplest scenario leading to a deadlock in the dining philosophers problem" loading="lazy" /></p>

<p>In this diagram, inclined arrows should be understood as lock-actions where the order in which threads perform them doesn’t matter. On the other hand, the horizontal line means that the threads should be “synchronized” at this point.</p>

<h2 id="avoiding-the-deadlock-with-a-semaphore">Avoiding the deadlock with a semaphore</h2>

<p>The program comes to a deadlock if there are <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> threads, such that the last operation each thread performed is locking a fork. We can use an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>-permit semaphore to ensure that this never happens:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// file: "Philosopher.java"</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Semaphore</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Philosopher</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Semaphore</span> <span class="n">semaphore</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Semaphore</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Fork</span> <span class="n">leftFork</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Fork</span> <span class="n">rightFork</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Philosopher</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="nc">Fork</span> <span class="n">leftFork</span><span class="o">,</span> <span class="nc">Fork</span> <span class="n">rightFork</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftFork</span> <span class="o">=</span> <span class="n">leftFork</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rightFork</span> <span class="o">=</span> <span class="n">rightFork</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(;;)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is thinking..."</span><span class="o">);</span>
            <span class="n">semaphore</span><span class="o">.</span><span class="na">acquireUninterruptibly</span><span class="o">();</span>
            <span class="n">rightFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="n">leftFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="n">semaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is eating..."</span><span class="o">);</span>
            <span class="n">leftFork</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" has put down the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="n">rightFork</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" has put down the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>In other words, the idea of this solution is to make sure only <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> threads at most are “stuck” in the dangerous zone - between lines <code class="language-plaintext highlighter-rouge">rightFork.get(id);</code> and <code class="language-plaintext highlighter-rouge">leftFork.get(id);</code>. With this change to the <code class="language-plaintext highlighter-rouge">Philosopher</code> class, deadlock’s aren’t possible anymore.</p>

<h2 id="one-philosopher-can-just-be-left-handed">One philosopher can just be left-handed</h2>

<p>We can systematically analyze the deadlock occurring in the program if we consider 4 necessary conditions for a deadlock, according to Edward Coffman:</p>

<ol>
  <li><em>Mutual exclusion</em> — at least one held resource must be non-sharable.</li>
  <li><em>Hold and wait</em> — there exists at least one process holding a resource and waiting for another one.</li>
  <li><em>No preemption</em> — resources cannot be preempted. For example, it is impossible to force a thread to release a lock safely.</li>
  <li><em>Circular wait</em> — Processes wait for each other in a cycle.</li>
</ol>

<p>Turning to the present problem, we see directly that the first 3 conditions hold.</p>

<p>We can analyze whether the circular-condition holds by constructing the so-called <em>precedence-graph</em>. For each resource (in this case, for each fork), we create a node. If it is possible, that process <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in some state locks resource <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> and waits for resource <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>, then node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span> should be added to the graph:</p>

<p><img src="/assets/img/blog/dining-philosophers-precgraph.svg" alt="Precedence graph for the dining philosophers problem" loading="lazy" /></p>

<p>Clearly, there is a cycle in this graph, so a state in which all threads wait for each other is possible (Circular-wait condition holds).</p>

<p>In order to make the graph acyclic, it is sufficient to just flip the direction of one arbitrary arrow. In terms of the problem, this means changing the behavior of one philosopher to first take the left fork, and then the right one. It doesn’t matter in which order forks are put back on the table. So, this change will prevent deadlocks:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// file: "Philosopher.java"</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Philosopher</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Fork</span> <span class="n">leftFork</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Fork</span> <span class="n">rightFork</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Philosopher</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="nc">Fork</span> <span class="n">leftFork</span><span class="o">,</span> <span class="nc">Fork</span> <span class="n">rightFork</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftFork</span> <span class="o">=</span> <span class="n">leftFork</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rightFork</span> <span class="o">=</span> <span class="n">rightFork</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(;;)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is thinking..."</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">id</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">leftFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
                <span class="n">rightFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="n">rightFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
                <span class="n">leftFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is eating..."</span><span class="o">);</span>
            <span class="n">leftFork</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" has put down the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="n">rightFork</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" has put down the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>This code changes the behavior of philosopher 0 — now this philosopher first takes the left fork, leading us to the following acyclic precedence graph:</p>

<p><img src="/assets/img/blog/dining-philosophers-acyclic-precgraph.svg" alt="Precedence graph for the dining philosophers problem with the deadlock fixed" loading="lazy" /></p>

<h2 id="even-more-efficient-solution">Even more efficient solution</h2>

<p>When possible, it is a good idea to get rid of long paths in the precedence graph, because this will improve the overall concurrency of the system. In this case, we can make even philosophers first take the left fork and odd ones — the right fork first. This idea leads us to the following precedence graph:</p>

<p><img src="/assets/img/blog/dining-philosophers-acyclic-precgraph-2.svg" alt="Precedence graph for the improved solution" loading="lazy" /></p>

<p>and the little change in code:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// file: "Philosopher.java"</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Philosopher</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Fork</span> <span class="n">leftFork</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Fork</span> <span class="n">rightFork</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Philosopher</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="nc">Fork</span> <span class="n">leftFork</span><span class="o">,</span> <span class="nc">Fork</span> <span class="n">rightFork</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">leftFork</span> <span class="o">=</span> <span class="n">leftFork</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rightFork</span> <span class="o">=</span> <span class="n">rightFork</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(;;)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is thinking..."</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">id</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">leftFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
                <span class="n">rightFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="n">rightFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
                <span class="n">leftFork</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" took the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is eating..."</span><span class="o">);</span>
            <span class="n">leftFork</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" has put down the left fork "</span> <span class="o">+</span> <span class="n">leftFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
            <span class="n">rightFork</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Philosopher "</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" has put down the right fork "</span> <span class="o">+</span> <span class="n">rightFork</span><span class="o">.</span><span class="na">id</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

  
</article>



  <hr class="dingbat related mb6" />






  
     


  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img
  
    src="/assets/icons/icon.png"
    srcset="/assets/icons/logo_128.png 1x,/assets/icons/logo_256.png 2x"
    
  
  alt="Alexander Mayorov"
  class="avatar"
  
  width="120"
  height="120"
  loading="lazy"
/>

  

  
  
  <h2  class="page-title hr-bottom">
    About
  </h2>

  <p>Computer Science student &amp; backend developer</p>


  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/ZeroBone" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:zb@zerobone.net" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://t.me/zerobone" title="Telegram" class="no-mark-external">
      <span class="icon-telegram"></span>
      <span class="sr-only">Telegram</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.linkedin.com/in/zerobone" title="LinkedIn" class="no-mark-external">
      <span class="icon-linkedin2"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://instagram.com/zerobonezb" title="Instagram" class="no-mark-external">
      <span class="icon-instagram"></span>
      <span class="sr-only">Instagram</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>


  

  
    


  <aside class="other-projects related mb0" role="complementary">  <h2>Related Posts</h2>  <div class="columns">          <div class="column column-1-2">                  <article class="project-card">  <a href="/blog/cs/ip-pspace/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="/assets/img/blog/ip-pspace-tmb.jpg"    srcset="/assets/img/blog/ip-pspace-tmb.jpg 1280w,/assets/img/blog/ip-pspace-tmb@0,5x.jpg 640w,/assets/img/blog/ip-pspace-tmb@0,25x.jpg 320w,/assets/img/blog/ip-pspace-tmb@0,125x.jpg 160w"    sizes="(min-width:86em)27.5rem,(min-width:54em)24.5rem,(min-width:42em)21.5rem,42rem"    alt="Visualization and detailed description of the interactive protocol for TQBF yielding IP = PSPACE"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/cs/ip-pspace/" class="flip-title">Visualization and detailed description of the interactive protocol for TQBF yielding IP = PSPACE</a>  </h3>      <a class="fill-card no-hover" href="/blog/cs/ip-pspace/" tabindex="-1"><span class="sr-only">Continue reading Visualization and detailed description of the interactive protocol for TQBF yielding IP = PSPACE</span></a></article>              </div>          <div class="column column-1-2">                  <article class="project-card">  <a href="/blog/cs/restricted-injective-mapping-np-complete/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="/assets/img/blog/restricted-injective-mapping-np-complete.jpg"    srcset="/assets/img/blog/restricted-injective-mapping-np-complete.jpg 1920w,/assets/img/blog/restricted-injective-mapping-np-complete@0,5x.jpg 960w,/assets/img/blog/restricted-injective-mapping-np-complete@0,25x.jpg 480w,/assets/img/blog/restricted-injective-mapping-np-complete@0,125x.jpg 240w"    sizes="(min-width:86em)27.5rem,(min-width:54em)24.5rem,(min-width:42em)21.5rem,42rem"    alt="Finding an injective mapping with restrictions for values is NP-Complete"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/cs/restricted-injective-mapping-np-complete/" class="flip-title">Finding an injective mapping with restrictions for values is NP-Complete</a>  </h3>      <a class="fill-card no-hover" href="/blog/cs/restricted-injective-mapping-np-complete/" tabindex="-1"><span class="sr-only">Continue reading Finding an injective mapping with restrictions for values is NP-Complete</span></a></article>              </div>      </div></aside>

  

  
    


  <aside class="other-projects related mb0" role="complementary">  <h2>Random Posts</h2>  <div class="columns">        <div class="column column-1-2">            <article class="project-card">  <a href="/blog/cs/svd-image-compression/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="/assets/img/blog/svd-image-compression-tmb.jpg"    srcset="/assets/img/blog/svd-image-compression-tmb.jpg 1280w,/assets/img/blog/svd-image-compression-tmb@0,5x.jpg 640w,/assets/img/blog/svd-image-compression-tmb@0,25x.jpg 320w,/assets/img/blog/svd-image-compression-tmb@0,125x.jpg 160w"    sizes="(min-width:86em)27.5rem,(min-width:54em)24.5rem,(min-width:42em)21.5rem,42rem"    alt="Compressing images with singular value decomposition (SVD)"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/cs/svd-image-compression/" class="flip-title">Compressing images with singular value decomposition (SVD)</a>  </h3>      <a class="fill-card no-hover" href="/blog/cs/svd-image-compression/" tabindex="-1"><span class="sr-only">Continue reading Compressing images with singular value decomposition (SVD)</span></a></article>          </div>        <div class="column column-1-2">            <article class="project-card">  <a href="/blog/cs/knuth-morris-pratt/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="/assets/img/blog/kmp-tmb.jpg"    srcset="/assets/img/blog/kmp-tmb.jpg 1170w,/assets/img/blog/kmp-tmb@0,5x.jpg 585w,/assets/img/blog/kmp-tmb@0,25x.jpg 292w,/assets/img/blog/kmp-tmb@0,125x.jpg 146w"    sizes="(min-width:86em)27.5rem,(min-width:54em)24.5rem,(min-width:42em)21.5rem,42rem"    alt="Knuth-Morris-Pratt (KMP) algorithm explained"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/cs/knuth-morris-pratt/" class="flip-title">Knuth-Morris-Pratt (KMP) algorithm explained</a>  </h3>      <a class="fill-card no-hover" href="/blog/cs/knuth-morris-pratt/" tabindex="-1"><span class="sr-only">Continue reading Knuth-Morris-Pratt (KMP) algorithm explained</span></a></article>          </div>      </div></aside>

  

  
    
<aside class="comments related" role="complementary">
  <h2 class="hr-bottom">Comments</h2>
  

<div id="disqus_thread"></div>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>!function(w, d) {
  if (d.getElementById("disqus_thread")) {
    if (w.DISQUS) {
      w.DISQUS.reset({
        reload: true,
        config() {
          this.page.url = w.location.href;
          this.page.title = d.title;
        },
      });
    } else {
      w.disqus_config = function disqusConfig() {
        this.page.url = w.location.href;
        this.page.title = d.title;
      };
      w.loadJSDeferred(d.getElementById("_hrefDisqus").href + '/embed.js');
    }
  }
}(window, document);</script>


</aside>


  


  
<footer class="content" role="contentinfo">
  <hr/>
  
    <p><small class="copyright">Copyright © 2019 — 2022 Alexander Mayorov. All rights reserved.
</small></p>
  
  
    <nav class="legal"><small>
    
      
      <a class="heading flip-title" href="/legal/cookies/">Cookies Policy</a>
      
    
    </small></nav>
  
  
  <hr class="sr-only"/>
</footer>


</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg " style="background:rgb(10,41,132)"></div>

    <div class="sidebar-sticky">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="/assets/icons/icon.png" class="avatar" alt="ZeroBone" width="120" height="120" loading="lazy" />
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h1">ZeroBone</h2></a>
    
    
      <p class="">
        I am a computer science student and a backend developer

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/blog/"
          class="sidebar-nav-item "
          
        >
          Blog
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/projects/"
          class="sidebar-nav-item "
          
        >
          Projects
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/cv/"
          class="sidebar-nav-item "
          
        >
          CV
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/ZeroBone" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:zb@zerobone.net" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://t.me/zerobone" title="Telegram" class="no-mark-external">
      <span class="icon-telegram"></span>
      <span class="sr-only">Telegram</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.linkedin.com/in/zerobone" title="LinkedIn" class="no-mark-external">
      <span class="icon-linkedin2"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://instagram.com/zerobonezb" title="Instagram" class="no-mark-external">
      <span class="icon-instagram"></span>
      <span class="sr-only">Instagram</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>!function(){var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())}();
</script>
  <script src="/assets/js/hydejack-9.1.6.js" type="module"></script>
  <script src="/assets/js/LEGACY-hydejack-9.1.6.js" nomodule defer></script>
  

  
  <script>!function(w, d) {
    w.ga=w.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

    /**/
      if (navigator.CookiesOK) {
        ga('create', 'UA-76998425-9', 'auto');
      } else if (d.cookie.indexOf("hy--cookies-ok=true") > -1) {
        ga('create', 'UA-76998425-9', {
          'storage': 'none',
          'clientId': localStorage ? localStorage.getItem('ga--client-id') : undefined
        });
      } else {
        ga('create', 'UA-76998425-9', {
          'storage': 'none'
        });
        ga('set', 'forceSSL', true);
        ga('set', 'anonymizeIp', true);
      }
    /**/

    var pushStateEl = d.getElementById('_pushState');
    var timeoutId;
    pushStateEl.addEventListener('hy-push-state-load', function() {
      w.clearTimeout(timeoutId);
      timeoutId = w.setTimeout(function() {
        ga('set', 'page', w.location.pathname);
        ga('send', 'pageview');
      }, 500);
    });

    d.addEventListener('hy--cookies-ok', function () {
      w.ga(function(tracker) {
        w.ga("set", "anonymizeIp", undefined);
        localStorage && localStorage.setItem("ga--client-id", tracker.get("clientId"));
      });
    });

    w.loadJSDeferred('https://www.google-analytics.com/analytics.js');
  }(window, document);</script>


  <script type="module">
    if ('serviceWorker' in navigator) {
      /**/
      navigator.serviceWorker.getRegistration()
        .then(r => r.unregister())
        .catch(() => {});
      /**/
    }
  </script>
<!--<![endif]-->
  <!-- <script>
  document.querySelector('hy-push-state').setAttribute('prefetch', '');

  document.querySelectorAll('.sidebar a[href^="/"]').forEach(function (el) { 
    el.addEventListener('click', function (e) {
      if (el.pathname === window.location.pathname) {
        e.preventDefault();
        e.stopPropagation();
        document.querySelector('hy-drawer').close();
      }
    });
  });
</script> -->

<!--
Code for integrating CloudFlare's email protection with Hydejack's single page app loading.
-->
<script>
  document.getElementById('_pushState').addEventListener('hy-push-state-after', function (e) {
    function e(e){
      (console.error?console.error:console.log).call(console,e)
    }

    function t(e){
      return l.innerHTML='<a href="'+e.replace(/"/g,"&quot;")+'"></a>',l.childNodes[0].getAttribute("href")
    }

    function r(e,t){
      var r=e.substr(t,2);return parseInt(r,16)
    }

    function n(e,n){
      for(var o="",c=r(e,n),a=n+2;a<e.length;a+=2){
        var l=r(e,a)^c;
        o+=String.fromCharCode(l)
      }
      return t(o)
    }

    var o="/cdn-cgi/l/email-protection#",
        c=".__cf_email__",
        a="data-cfemail",
        l=document.createElement("div");

    !function(){
      for(var t=document.getElementsByTagName("a"),r=0;r<t.length;r++)
        try{
          var c=t[r],a=c.href.indexOf(o);
          a>-1&&(c.href="mailto:"+n(c.href,a+o.length))
        }catch(t){
          e(t)
        }
    }(),
    function(){
      for(var t=document.querySelectorAll(c),r=0;r<t.length;r++)
        try{
          var o=t[r],l=n(o.getAttribute(a),0),i=document.createTextNode(l);
          o.parentNode.replaceChild(i,o)
        }catch(t){
          e(t)
        }
    }()
  });
</script>





<div hidden>
  
  <h2 class="sr-only">Templates (for web app):</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loading…</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Oops</h1>
    
    
    <p class="lead">
      Oops, an error occurred while loading <a class="this-link" href=""></a>.

    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
    <template id="_cookies-banner-template">
  <div id="_cookies-banner" class="navbar fixed-bottom CookiesOK">
    <div class="content">
      <div class="nav-btn-bar">
        <small class="faded">
          <span>This site uses cookies. For more information, see the <a href="/legal/cookies/">Cookies Policy</a>.
</span>
          <button id="_cookies-ok" class="btn btn-primary btn-sm">Ok</button>
        </small>
      </div>
    </div>
  </div>
</template>

  
  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover" >
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
  
    <template id="_search-template">
  <button id="_search" class="nav-btn no-hover">
    <label class="sr-only" for="_search-input">Search</label>
    <span class="icon-search"></span>
  </button>
  <div id="_search-box">
    <div class="nav-btn">
      <span class="icon-search"></span>
    </div>
    <input 
      id="_search-input"
      type="search"
      class="form-control form-control-lg nav-btn"
      placeholder="Build with JEKYLL_ENV=production to enable search."
    />
    <button type="reset" class="nav-btn no-hover">
      <span class="sr-only">Close</span>
      <span class="icon-cross"></span>
    </button>
  </div>
  <div id="_hits"></div>
</template>

  
</div>

</body>
</html>
