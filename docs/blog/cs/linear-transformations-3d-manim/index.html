<!DOCTYPE html>
<html lang="en">







<head>
  






  
    
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Visualizing 3D linear transformations and Gaussian elimination with Python and Manim | ZeroBone</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Visualizing 3D linear transformations and Gaussian elimination with Python and Manim" />
<meta name="author" content="zerobone" />
<meta property="og:locale" content="en" />
<meta name="description" content="Matrices are omnipresent in linear algebra. Columns of a matrix describe where the corresponding basis vectors land relative to the initial basis. All transformed vectors are linear combinations of transformed basis vectors which are the columns of the matrix, this is also called linearity. Algorithms that operate on matrices essentially just alter the way vectors get transformed, preserving some properties. Unfortunately, many algorithms are typically presented to students in a numerical fashion, without describing the whole graphical meaning. In this post we will first visualize simple linear transformations and then we will visualize Gaussian Elimination (with row swaps) steps as a sequence of linear transformations. To do this, we will use Python together with a popular Open-Source library manim." />
<meta property="og:description" content="Matrices are omnipresent in linear algebra. Columns of a matrix describe where the corresponding basis vectors land relative to the initial basis. All transformed vectors are linear combinations of transformed basis vectors which are the columns of the matrix, this is also called linearity. Algorithms that operate on matrices essentially just alter the way vectors get transformed, preserving some properties. Unfortunately, many algorithms are typically presented to students in a numerical fashion, without describing the whole graphical meaning. In this post we will first visualize simple linear transformations and then we will visualize Gaussian Elimination (with row swaps) steps as a sequence of linear transformations. To do this, we will use Python together with a popular Open-Source library manim." />
<link rel="canonical" href="http://localhost:4000/blog/cs/linear-transformations-3d-manim/" />
<meta property="og:url" content="http://localhost:4000/blog/cs/linear-transformations-3d-manim/" />
<meta property="og:site_name" content="ZeroBone" />
<meta property="og:image" content="http://localhost:4000/assets/img/blog/linear-transformation-3d-tmb.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-15T00:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/blog/linear-transformation-3d-tmb.jpg" />
<meta property="twitter:title" content="Visualizing 3D linear transformations and Gaussian elimination with Python and Manim" />
<meta name="twitter:site" content="@ZeroBone21" />
<meta name="twitter:creator" content="@zerobone" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"zerobone"},"dateModified":"2020-12-16T00:00:00+01:00","datePublished":"2020-12-15T00:00:00+01:00","description":"Matrices are omnipresent in linear algebra. Columns of a matrix describe where the corresponding basis vectors land relative to the initial basis. All transformed vectors are linear combinations of transformed basis vectors which are the columns of the matrix, this is also called linearity. Algorithms that operate on matrices essentially just alter the way vectors get transformed, preserving some properties. Unfortunately, many algorithms are typically presented to students in a numerical fashion, without describing the whole graphical meaning. In this post we will first visualize simple linear transformations and then we will visualize Gaussian Elimination (with row swaps) steps as a sequence of linear transformations. To do this, we will use Python together with a popular Open-Source library manim.","headline":"Visualizing 3D linear transformations and Gaussian elimination with Python and Manim","image":{"srcset":{"1920w":"/assets/img/blog/linear-transformation-3d-tmb.jpg","960w":"/assets/img/blog/linear-transformation-3d-tmb@0,5x.jpg","480w":"/assets/img/blog/linear-transformation-3d-tmb@0,25x.jpg","240w":"/assets/img/blog/linear-transformation-3d-tmb@0,125x.jpg"},"url":"http://localhost:4000/assets/img/blog/linear-transformation-3d-tmb.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/cs/linear-transformations-3d-manim/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/icons/icon.png"},"name":"zerobone"},"url":"http://localhost:4000/blog/cs/linear-transformations-3d-manim/"}</script>
<!-- End Jekyll SEO tag -->


  

  
    <meta name="keywords" content="ZeroBone,Alexander,Mayorov,Computer Science,CS,Mathematics,Math">
  



  <meta name="theme-color" content="rgb(10,41,132)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="ZeroBone">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="ZeroBone">

<meta name="generator" content="Hydejack v9.1.6" />


<link rel="alternate" href="http://localhost:4000/blog/cs/linear-transformations-3d-manim/" hreflang="en">

<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="ZeroBone" />


<link rel="shortcut icon"    href="/assets/icons/favicon.ico">
<link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">

<link rel="manifest" href="/assets/site.webmanifest">

<link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com">


  <link rel="dns-prefetch" href="https://www.google-analytics.com">


<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">

<link rel="dns-prefetch" href="/assets/js/search-worker-9.1.6.js" as="worker" id="_hrefSearch">

  
  <link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css" id="_katexPreload">
  <noscript><link rel="stylesheet" href="/assets/bower_components/katex/dist/katex.min.css"></noscript>




<link rel="dns-prefetch" href="https://zerobone.disqus.com" id="_hrefDisqus">


<script>!function(r,c){"use strict";function a(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=c.createElement("script"),e=(n.src=e,t&&a(n,"load",t,{once:!0}),c.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=c.createElement("script");function o(){r._loaded=!0,t&&a(n,"load",t,{once:!0});var e=c.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():a(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){a(c.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}}(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = true;
  w._noToc = true;
  w._noSearch = false;
  w._advertise = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2022-09-05T00:44:00+02:00',
  };
  w._clapButton = true;
}(window);</script>



<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.1.6.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700%7CNoto+Sans:400,400i,700,700i&display=swap" id="_fontsPreload">



  <style id="_pageStyle">

html{--accent-color: rgb(80,178,185);--accent-color-faded: rgba(80,178,185,0.5);--accent-color-highlight: rgba(80,178,185,0.1);--accent-color-darkened: #419ba2;--theme-color: rgb(10,41,132);--dark-mode-body-bg: #282a31;--dark-mode-border-color: #333640}

</style>


<!--<![endif]-->


<!-- Add HTML tags here to be included in the head -->


</head>

<body class="no-toc no-break-layout no-large-headings no-third-column">
  


<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-post"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/">blog</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/cs/">cs</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>linear-transformations-3d-manim</span>
        
      </li>
    
  
</ul></nav>
  










<article id="post-blog-cs-linear-transformations-3d-manim" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        Visualizing 3D linear transformations and Gaussian elimination with Python and Manim
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2020-12-15T00:00:00+01:00">15.12.2020</time> in <a href="/blog/cs/" class="flip-title">Computer Science</a> &#8594; <a href="/tag/linalg/" class="flip-title">Linear algebra</a>
      </span>
      
        
          
          
          
            
            
            <span class="ellipsis" data-tippy-content="Last modified at: 16.12.2020">
              <span class="sr-only">Last modified at:</span>
              <span class="icon-history"></span>
              <time datetime="2020-12-16T00:00:00+01:00">16.12.2020</time>
            </span>
          
        
      
    </div>

    
    
      
        <div class="img-wrapper lead aspect-ratio sixteen-nine flip-project-img">
          


<img
  
    src="/assets/img/blog/linear-transformation-3d-tmb.jpg"
    srcset="/assets/img/blog/linear-transformation-3d-tmb.jpg 1920w,/assets/img/blog/linear-transformation-3d-tmb@0,5x.jpg 960w,/assets/img/blog/linear-transformation-3d-tmb@0,25x.jpg 480w,/assets/img/blog/linear-transformation-3d-tmb@0,125x.jpg 240w"
    
  
  alt="Visualizing 3D linear transformations and Gaussian elimination with Python and Manim"
  
  
  width="864"
  height="486"
  loading="lazy"
/>

        </div>
      
      
    

    



  


  </header>

  
    <p>Matrices are omnipresent in linear algebra. Columns of a matrix describe where the corresponding basis vectors land relative to the initial basis. All transformed vectors are linear combinations of transformed basis vectors which are the columns of the matrix, this is also called linearity. Algorithms that operate on matrices essentially just alter the way vectors get transformed, preserving some properties. Unfortunately, many algorithms are typically presented to students in a numerical fashion, without describing the whole graphical meaning. In this post we will first visualize simple linear transformations and then we will visualize Gaussian Elimination (with row swaps) steps as a sequence of linear transformations. To do this, we will use Python together with a popular Open-Source library <code class="language-plaintext highlighter-rouge">manim</code>.</p>

<h2 id="visualizing-3d-transformations">Visualizing 3D transformations</h2>

<p>In <code class="language-plaintext highlighter-rouge">manim</code>, there is a special <code class="language-plaintext highlighter-rouge">ApplyMatrix</code> animation that allows us to natively apply a matrix to every 3D vertex of the object.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">manimlib.imports</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">LinearTransformation3D</span><span class="p">(</span><span class="n">ThreeDScene</span><span class="p">):</span>

    <span class="n">CONFIG</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"x_axis_label"</span><span class="p">:</span> <span class="s">"$x$"</span><span class="p">,</span>
        <span class="s">"y_axis_label"</span><span class="p">:</span> <span class="s">"$y$"</span><span class="p">,</span>
        <span class="s">"basis_i_color"</span><span class="p">:</span> <span class="n">GREEN</span><span class="p">,</span>
        <span class="s">"basis_j_color"</span><span class="p">:</span> <span class="n">RED</span><span class="p">,</span>
        <span class="s">"basis_k_color"</span><span class="p">:</span> <span class="n">GOLD</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">np_matrix</span><span class="p">):</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">np_matrix</span><span class="p">)</span>

        <span class="n">m</span><span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">m</span><span class="p">.</span><span class="n">set_column_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

        <span class="n">m</span><span class="p">.</span><span class="n">to_corner</span><span class="p">(</span><span class="n">UP</span> <span class="o">+</span> <span class="n">LEFT</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">m</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">])</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">ThreeDAxes</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">GRAY</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">axes</span><span class="p">.</span><span class="n">get_axis_labels</span><span class="p">())</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">set_camera_orientation</span><span class="p">(</span><span class="n">phi</span><span class="o">=</span><span class="mi">75</span> <span class="o">*</span> <span class="n">DEGREES</span><span class="p">,</span> <span class="n">theta</span><span class="o">=-</span><span class="mi">45</span> <span class="o">*</span> <span class="n">DEGREES</span><span class="p">)</span>

        <span class="c1"># basis vectors i,j,k
</span>        <span class="n">basis_vector_helper</span> <span class="o">=</span> <span class="n">TextMobject</span><span class="p">(</span><span class="s">"$i$"</span><span class="p">,</span> <span class="s">","</span><span class="p">,</span> <span class="s">"$j$"</span><span class="p">,</span> <span class="s">","</span><span class="p">,</span> <span class="s">"$k$"</span><span class="p">)</span>
        <span class="n">basis_vector_helper</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">)</span>
        <span class="n">basis_vector_helper</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">)</span>
        <span class="n">basis_vector_helper</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

        <span class="n">basis_vector_helper</span><span class="p">.</span><span class="n">to_corner</span><span class="p">(</span><span class="n">UP</span> <span class="o">+</span> <span class="n">RIGHT</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">add_fixed_in_frame_mobjects</span><span class="p">(</span><span class="n">basis_vector_helper</span><span class="p">)</span>

        <span class="c1"># matrix
</span>        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">create_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">add_fixed_in_frame_mobjects</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

        <span class="c1"># axes &amp; camera
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">begin_ambient_camera_rotation</span><span class="p">(</span><span class="n">rate</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="n">cube</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">(</span><span class="n">side_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">BLUE</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">cube</span><span class="p">.</span><span class="n">set_stroke</span><span class="p">(</span><span class="n">BLUE_E</span><span class="p">)</span>

        <span class="n">i_vec</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">)</span>
        <span class="n">j_vec</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">)</span>
        <span class="n">k_vec</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

        <span class="n">i_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">M</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">)</span>
        <span class="n">j_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">M</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">)</span>
        <span class="n">k_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">M</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span>
            <span class="n">ShowCreation</span><span class="p">(</span><span class="n">cube</span><span class="p">),</span>
            <span class="n">GrowArrow</span><span class="p">(</span><span class="n">i_vec</span><span class="p">),</span>
            <span class="n">GrowArrow</span><span class="p">(</span><span class="n">j_vec</span><span class="p">),</span>
            <span class="n">GrowArrow</span><span class="p">(</span><span class="n">k_vec</span><span class="p">),</span>
            <span class="n">Write</span><span class="p">(</span><span class="n">basis_vector_helper</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="n">matrix_anim</span> <span class="o">=</span> <span class="n">ApplyMatrix</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">cube</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span>
            <span class="n">matrix_anim</span><span class="p">,</span>
            <span class="n">Transform</span><span class="p">(</span><span class="n">i_vec</span><span class="p">,</span> <span class="n">i_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                      <span class="n">run_time</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">()),</span>
            <span class="n">Transform</span><span class="p">(</span><span class="n">j_vec</span><span class="p">,</span> <span class="n">j_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                      <span class="n">run_time</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">()),</span>
            <span class="n">Transform</span><span class="p">(</span><span class="n">k_vec</span><span class="p">,</span> <span class="n">k_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                      <span class="n">run_time</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">())</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</code></pre></div></div>

<p>With this implementation we can visualize, for example, the following matrix presented in the video (top left corner):</p>

<video controls="">
	<source src="/assets/videos/blog/linear-transformation-3d.mp4" type="video/mp4" />
	Your browser does not support the video tag.
</video>

<p>We can also visualize what it means for 2 columns to be linear dependent — the cube gets squashed into a plane:</p>

<video controls="">
	<source src="/assets/videos/blog/linear-transformation-3d-linear-dependent.mp4" type="video/mp4" />
	Your browser does not support the video tag.
</video>

<h2 id="visualizing-gaussian-elimination">Visualizing Gaussian elimination</h2>

<p>In the <a href="/blog/cs/pa-lu-factorization/">previous post</a> we implemented an advanced version of the Gaussian elimination algorithm with pivoting (the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>A</mi><mo>=</mo><mi>L</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">PA = LU</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span> decomposition). We can analogously implement the pure Gaussian Elimination algorithm with pivoting the following way:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">gauss</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">pivotRow</span> <span class="o">=</span> <span class="n">x</span>

        <span class="c1"># search for the best pivot
</span>        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">pivotRow</span><span class="p">][</span><span class="n">x</span><span class="p">]):</span>
                <span class="n">pivotRow</span> <span class="o">=</span> <span class="n">y</span>

        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">pivotRow</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># we didn't find any row with a non-zero leading coefficient
</span>            <span class="c1"># that means that the matrix has all zeroes in this column
</span>            <span class="c1"># so we don't need to search for pivots after all for the current column x
</span>            <span class="k">continue</span>

        <span class="c1"># did we just use a pivot that is not on the diagonal?
</span>        <span class="k">if</span> <span class="n">pivotRow</span> <span class="o">!=</span> <span class="n">x</span><span class="p">:</span>
            <span class="c1"># swap the pivot row with the current row in both A and L matrices
</span>            <span class="n">a</span><span class="p">[[</span><span class="n">x</span><span class="p">,</span> <span class="n">pivotRow</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[[</span><span class="n">pivotRow</span><span class="p">,</span> <span class="n">x</span><span class="p">]]</span>
            <span class="k">yield</span> <span class="n">a</span>

        <span class="c1"># now the pivot row is x
</span>        <span class="c1"># search for rows where the leading coefficient must be eliminated
</span>        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">currentValue</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">currentValue</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># variable already eliminated, nothing to do
</span>                <span class="k">continue</span>

            <span class="n">pivot</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">pivot</span> <span class="o">!=</span> <span class="mi">0</span>  <span class="c1"># just in case, we already made sure the pivot is not zero
</span>
            <span class="n">pivotFactor</span> <span class="o">=</span> <span class="n">currentValue</span> <span class="o">/</span> <span class="n">pivot</span>

            <span class="c1"># subtract the pivot row from the current row
</span>
            <span class="n">a</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">a</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">pivotFactor</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

            <span class="k">yield</span> <span class="n">a</span>
</code></pre></div></div>

<p>Notice that after every matrix operation we want to visualize I’ve added a <code class="language-plaintext highlighter-rouge">yield</code> statement. Generators in Python are perfect for visualizing algorithms, because they allow us to save the current state, yield the value and then continue the execution when the caller handled the received value. In this case, we yield every version of the matrix as the algorithm runs.</p>

<p>Now we can adjust and extend the code used to render linear transformations to do this for every step of the gaussian elimination:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Gauss3D</span><span class="p">(</span><span class="n">ThreeDScene</span><span class="p">):</span>

    <span class="n">CONFIG</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"x_axis_label"</span><span class="p">:</span> <span class="s">"$x$"</span><span class="p">,</span>
        <span class="s">"y_axis_label"</span><span class="p">:</span> <span class="s">"$y$"</span><span class="p">,</span>
        <span class="s">"basis_i_color"</span><span class="p">:</span> <span class="n">GREEN</span><span class="p">,</span>
        <span class="s">"basis_j_color"</span><span class="p">:</span> <span class="n">RED</span><span class="p">,</span>
        <span class="s">"basis_k_color"</span><span class="p">:</span> <span class="n">GOLD</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">np_matrix</span><span class="p">):</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">np_matrix</span><span class="p">)</span>

        <span class="n">m</span><span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">m</span><span class="p">.</span><span class="n">set_column_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

        <span class="n">m</span><span class="p">.</span><span class="n">to_corner</span><span class="p">(</span><span class="n">UP</span> <span class="o">+</span> <span class="n">LEFT</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">m</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
        <span class="p">])</span>

        <span class="c1"># axes
</span>        <span class="n">axes</span> <span class="o">=</span> <span class="n">ThreeDAxes</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">GRAY</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">axes</span><span class="p">.</span><span class="n">get_axis_labels</span><span class="p">())</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">set_camera_orientation</span><span class="p">(</span><span class="n">phi</span><span class="o">=</span><span class="mi">55</span> <span class="o">*</span> <span class="n">DEGREES</span><span class="p">,</span> <span class="n">theta</span><span class="o">=-</span><span class="mi">45</span> <span class="o">*</span> <span class="n">DEGREES</span><span class="p">)</span>

        <span class="c1"># basis vectors i,j,k
</span>        <span class="n">basis_vector_helper</span> <span class="o">=</span> <span class="n">TextMobject</span><span class="p">(</span><span class="s">"$i$"</span><span class="p">,</span> <span class="s">","</span><span class="p">,</span> <span class="s">"$j$"</span><span class="p">,</span> <span class="s">","</span><span class="p">,</span> <span class="s">"$k$"</span><span class="p">)</span>
        <span class="n">basis_vector_helper</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">)</span>
        <span class="n">basis_vector_helper</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">)</span>
        <span class="n">basis_vector_helper</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

        <span class="n">basis_vector_helper</span><span class="p">.</span><span class="n">to_corner</span><span class="p">(</span><span class="n">UP</span> <span class="o">+</span> <span class="n">RIGHT</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">add_fixed_in_frame_mobjects</span><span class="p">(</span><span class="n">basis_vector_helper</span><span class="p">)</span>

        <span class="c1"># matrix
</span>        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">create_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">add_fixed_in_frame_mobjects</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

        <span class="c1"># axes &amp; camera
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">begin_ambient_camera_rotation</span><span class="p">(</span><span class="n">rate</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>

        <span class="n">cube</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">(</span><span class="n">side_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">BLUE</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">cube</span><span class="p">.</span><span class="n">set_stroke</span><span class="p">(</span><span class="n">BLUE_E</span><span class="p">)</span>  <span class="c1"># cube.set_stroke(TEAL_E)
</span>
        <span class="n">i_vec</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">)</span>
        <span class="n">j_vec</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">)</span>
        <span class="n">k_vec</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

        <span class="n">i_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">M</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">)</span>
        <span class="n">j_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">M</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">)</span>
        <span class="n">k_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">M</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span>
            <span class="n">ShowCreation</span><span class="p">(</span><span class="n">cube</span><span class="p">),</span>
            <span class="n">GrowArrow</span><span class="p">(</span><span class="n">i_vec</span><span class="p">),</span>
            <span class="n">GrowArrow</span><span class="p">(</span><span class="n">j_vec</span><span class="p">),</span>
            <span class="n">GrowArrow</span><span class="p">(</span><span class="n">k_vec</span><span class="p">),</span>
            <span class="n">Write</span><span class="p">(</span><span class="n">basis_vector_helper</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="n">matrix_anim</span> <span class="o">=</span> <span class="n">ApplyMatrix</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">cube</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span>
            <span class="n">matrix_anim</span><span class="p">,</span>
            <span class="n">ReplacementTransform</span><span class="p">(</span><span class="n">i_vec</span><span class="p">,</span> <span class="n">i_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                                 <span class="n">run_time</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">()),</span>
            <span class="n">ReplacementTransform</span><span class="p">(</span><span class="n">j_vec</span><span class="p">,</span> <span class="n">j_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                                 <span class="n">run_time</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">()),</span>
            <span class="n">ReplacementTransform</span><span class="p">(</span><span class="n">k_vec</span><span class="p">,</span> <span class="n">k_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                                 <span class="n">run_time</span><span class="o">=</span><span class="n">matrix_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">())</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="n">i_vec</span><span class="p">,</span> <span class="n">j_vec</span><span class="p">,</span> <span class="n">k_vec</span> <span class="o">=</span> <span class="n">i_vec_new</span><span class="p">,</span> <span class="n">j_vec_new</span><span class="p">,</span> <span class="n">k_vec_new</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gauss</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>

            <span class="n">a_rounded</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">copy</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

            <span class="bp">self</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

            <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">create_matrix</span><span class="p">(</span><span class="n">a_rounded</span><span class="p">)</span>

            <span class="bp">self</span><span class="p">.</span><span class="n">add_fixed_in_frame_mobjects</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

            <span class="c1"># transformed cube
</span>            <span class="n">new_cube</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">(</span><span class="n">side_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">BLUE</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">new_cube</span><span class="p">.</span><span class="n">set_stroke</span><span class="p">(</span><span class="n">BLUE_E</span><span class="p">)</span>

            <span class="n">new_cube</span><span class="p">.</span><span class="n">apply_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

            <span class="c1"># vectors
</span>            <span class="n">i_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_i_color</span><span class="p">)</span>
            <span class="n">j_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_j_color</span><span class="p">)</span>
            <span class="n">k_vec_new</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">basis_k_color</span><span class="p">)</span>

            <span class="c1"># prepare and run animation
</span>            <span class="n">cube_anim</span> <span class="o">=</span> <span class="n">ReplacementTransform</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">new_cube</span><span class="p">)</span>

            <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span>
                <span class="n">cube_anim</span><span class="p">,</span>
                <span class="n">ReplacementTransform</span><span class="p">(</span><span class="n">i_vec</span><span class="p">,</span> <span class="n">i_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">cube_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                                     <span class="n">run_time</span><span class="o">=</span><span class="n">cube_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">()),</span>
                <span class="n">ReplacementTransform</span><span class="p">(</span><span class="n">j_vec</span><span class="p">,</span> <span class="n">j_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">cube_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                                     <span class="n">run_time</span><span class="o">=</span><span class="n">cube_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">()),</span>
                <span class="n">ReplacementTransform</span><span class="p">(</span><span class="n">k_vec</span><span class="p">,</span> <span class="n">k_vec_new</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">cube_anim</span><span class="p">.</span><span class="n">get_rate_func</span><span class="p">(),</span>
                                     <span class="n">run_time</span><span class="o">=</span><span class="n">cube_anim</span><span class="p">.</span><span class="n">get_run_time</span><span class="p">())</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

            <span class="n">cube</span> <span class="o">=</span> <span class="n">new_cube</span>
            <span class="n">i_vec</span><span class="p">,</span> <span class="n">j_vec</span><span class="p">,</span> <span class="n">k_vec</span> <span class="o">=</span> <span class="n">i_vec_new</span><span class="p">,</span> <span class="n">j_vec_new</span><span class="p">,</span> <span class="n">k_vec_new</span>

            <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>We can now see graphically how the column vectors get aligned as we bring the matrix to upper triangular form:</p>

<video controls="">
	<source src="/assets/videos/blog/gaussian-elimination-3d.mp4" type="video/mp4" />
	Your browser does not support the video tag.
</video>

  
</article>



  <hr class="dingbat related mb6" />






  
     


  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img
  
    src="/assets/icons/icon.png"
    srcset="/assets/icons/logo_128.png 1x,/assets/icons/logo_256.png 2x"
    
  
  alt="Alexander Mayorov"
  class="avatar"
  
  width="120"
  height="120"
  loading="lazy"
/>

  

  
  
  <h2  class="page-title hr-bottom">
    About
  </h2>

  <p>Computer Science student &amp; backend developer</p>


  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/ZeroBone" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:zb@zerobone.net" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://t.me/zerobone" title="Telegram" class="no-mark-external">
      <span class="icon-telegram"></span>
      <span class="sr-only">Telegram</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.linkedin.com/in/zerobone" title="LinkedIn" class="no-mark-external">
      <span class="icon-linkedin2"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://instagram.com/zerobonezb" title="Instagram" class="no-mark-external">
      <span class="icon-instagram"></span>
      <span class="sr-only">Instagram</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>


  

  
    


  <aside class="other-projects related mb0" role="complementary">  <h2>Related Posts</h2>  <div class="columns">          <div class="column column-1-2">                  <article class="project-card">  <a href="/blog/cs/ip-pspace/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="/assets/img/blog/ip-pspace-tmb.jpg"    srcset="/assets/img/blog/ip-pspace-tmb.jpg 1280w,/assets/img/blog/ip-pspace-tmb@0,5x.jpg 640w,/assets/img/blog/ip-pspace-tmb@0,25x.jpg 320w,/assets/img/blog/ip-pspace-tmb@0,125x.jpg 160w"    sizes="(min-width:86em)27.5rem,(min-width:54em)24.5rem,(min-width:42em)21.5rem,42rem"    alt="Visualization and detailed description of the interactive protocol for TQBF yielding IP = PSPACE"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/cs/ip-pspace/" class="flip-title">Visualization and detailed description of the interactive protocol for TQBF yielding IP = PSPACE</a>  </h3>      <a class="fill-card no-hover" href="/blog/cs/ip-pspace/" tabindex="-1"><span class="sr-only">Continue reading Visualization and detailed description of the interactive protocol for TQBF yielding IP = PSPACE</span></a></article>              </div>          <div class="column column-1-2">                  <article class="project-card">  <a href="/blog/cs/restricted-injective-mapping-np-complete/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="/assets/img/blog/restricted-injective-mapping-np-complete.jpg"    srcset="/assets/img/blog/restricted-injective-mapping-np-complete.jpg 1920w,/assets/img/blog/restricted-injective-mapping-np-complete@0,5x.jpg 960w,/assets/img/blog/restricted-injective-mapping-np-complete@0,25x.jpg 480w,/assets/img/blog/restricted-injective-mapping-np-complete@0,125x.jpg 240w"    sizes="(min-width:86em)27.5rem,(min-width:54em)24.5rem,(min-width:42em)21.5rem,42rem"    alt="Finding an injective mapping with restrictions for values is NP-Complete"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/cs/restricted-injective-mapping-np-complete/" class="flip-title">Finding an injective mapping with restrictions for values is NP-Complete</a>  </h3>      <a class="fill-card no-hover" href="/blog/cs/restricted-injective-mapping-np-complete/" tabindex="-1"><span class="sr-only">Continue reading Finding an injective mapping with restrictions for values is NP-Complete</span></a></article>              </div>      </div></aside>

  

  
    


  <aside class="other-projects related mb0" role="complementary">  <h2>Random Posts</h2>  <div class="columns">        <div class="column column-1-2">            <article class="project-card">  <a href="/blog/cs/lowest-common-ancestor/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="/assets/img/blog/lowest-common-ancestor-tmb.jpg"    srcset="/assets/img/blog/lowest-common-ancestor-tmb.jpg 1920w,/assets/img/blog/lowest-common-ancestor-tmb@0,5x.jpg 960w,/assets/img/blog/lowest-common-ancestor-tmb@0,25x.jpg 480w,/assets/img/blog/lowest-common-ancestor-tmb@0,125x.jpg 240w"    sizes="(min-width:86em)27.5rem,(min-width:54em)24.5rem,(min-width:42em)21.5rem,42rem"    alt="Computing the lowest common ancestor in a full binary tree"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/cs/lowest-common-ancestor/" class="flip-title">Computing the lowest common ancestor in a full binary tree</a>  </h3>      <a class="fill-card no-hover" href="/blog/cs/lowest-common-ancestor/" tabindex="-1"><span class="sr-only">Continue reading Computing the lowest common ancestor in a full binary tree</span></a></article>          </div>        <div class="column column-1-2">            <article class="project-card">  <a href="/blog/cs/logic-minimization-gray-codes/" class="no-hover no-print-link flip-project" tabindex="-1">    <div class="project-card-img aspect-ratio sixteen-nine flip-project-img">              <img      src="/assets/img/blog/gray-code-logic-minimization-tmb.jpg"    srcset="/assets/img/blog/gray-code-logic-minimization-tmb.jpg 1920w,/assets/img/blog/gray-code-logic-minimization-tmb@0,5x.jpg 960w,/assets/img/blog/gray-code-logic-minimization-tmb@0,25x.jpg 480w,/assets/img/blog/gray-code-logic-minimization-tmb@0,125x.jpg 240w"    sizes="(min-width:86em)27.5rem,(min-width:54em)24.5rem,(min-width:42em)21.5rem,42rem"    alt="How propositional logic minimization and gray codes are connected"      width="864"  height="486"  loading="lazy"/>          </div>  </a>  <h3 class="project-card-title flip-project-title">    <a href="/blog/cs/logic-minimization-gray-codes/" class="flip-title">How propositional logic minimization and gray codes are connected</a>  </h3>      <a class="fill-card no-hover" href="/blog/cs/logic-minimization-gray-codes/" tabindex="-1"><span class="sr-only">Continue reading How propositional logic minimization and gray codes are connected</span></a></article>          </div>      </div></aside>

  

  
    
<aside class="comments related" role="complementary">
  <h2 class="hr-bottom">Comments</h2>
  

<div id="disqus_thread"></div>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>!function(w, d) {
  if (d.getElementById("disqus_thread")) {
    if (w.DISQUS) {
      w.DISQUS.reset({
        reload: true,
        config() {
          this.page.url = w.location.href;
          this.page.title = d.title;
        },
      });
    } else {
      w.disqus_config = function disqusConfig() {
        this.page.url = w.location.href;
        this.page.title = d.title;
      };
      w.loadJSDeferred(d.getElementById("_hrefDisqus").href + '/embed.js');
    }
  }
}(window, document);</script>


</aside>


  


  
<footer class="content" role="contentinfo">
  <hr/>
  
    <p><small class="copyright">Copyright © 2019 — 2022 Alexander Mayorov. All rights reserved.
</small></p>
  
  
    <nav class="legal"><small>
    
      
      <a class="heading flip-title" href="/legal/cookies/">Cookies Policy</a>
      
    
    </small></nav>
  
  
  <hr class="sr-only"/>
</footer>


</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg " style="background:rgb(10,41,132)"></div>

    <div class="sidebar-sticky">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="/assets/icons/icon.png" class="avatar" alt="ZeroBone" width="120" height="120" loading="lazy" />
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h1">ZeroBone</h2></a>
    
    
      <p class="">
        I am a computer science student and a backend developer

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/blog/"
          class="sidebar-nav-item "
          
        >
          Blog
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/projects/"
          class="sidebar-nav-item "
          
        >
          Projects
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/cv/"
          class="sidebar-nav-item "
          
        >
          CV
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/ZeroBone" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:zb@zerobone.net" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://t.me/zerobone" title="Telegram" class="no-mark-external">
      <span class="icon-telegram"></span>
      <span class="sr-only">Telegram</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.linkedin.com/in/zerobone" title="LinkedIn" class="no-mark-external">
      <span class="icon-linkedin2"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://instagram.com/zerobonezb" title="Instagram" class="no-mark-external">
      <span class="icon-instagram"></span>
      <span class="sr-only">Instagram</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>!function(){var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())}();
</script>
  <script src="/assets/js/hydejack-9.1.6.js" type="module"></script>
  <script src="/assets/js/LEGACY-hydejack-9.1.6.js" nomodule defer></script>
  

  
  <script>!function(w, d) {
    w.ga=w.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

    /**/
      if (navigator.CookiesOK) {
        ga('create', 'UA-76998425-9', 'auto');
      } else if (d.cookie.indexOf("hy--cookies-ok=true") > -1) {
        ga('create', 'UA-76998425-9', {
          'storage': 'none',
          'clientId': localStorage ? localStorage.getItem('ga--client-id') : undefined
        });
      } else {
        ga('create', 'UA-76998425-9', {
          'storage': 'none'
        });
        ga('set', 'forceSSL', true);
        ga('set', 'anonymizeIp', true);
      }
    /**/

    var pushStateEl = d.getElementById('_pushState');
    var timeoutId;
    pushStateEl.addEventListener('hy-push-state-load', function() {
      w.clearTimeout(timeoutId);
      timeoutId = w.setTimeout(function() {
        ga('set', 'page', w.location.pathname);
        ga('send', 'pageview');
      }, 500);
    });

    d.addEventListener('hy--cookies-ok', function () {
      w.ga(function(tracker) {
        w.ga("set", "anonymizeIp", undefined);
        localStorage && localStorage.setItem("ga--client-id", tracker.get("clientId"));
      });
    });

    w.loadJSDeferred('https://www.google-analytics.com/analytics.js');
  }(window, document);</script>


  <script type="module">
    if ('serviceWorker' in navigator) {
      /**/
      navigator.serviceWorker.getRegistration()
        .then(r => r.unregister())
        .catch(() => {});
      /**/
    }
  </script>
<!--<![endif]-->
  <!-- <script>
  document.querySelector('hy-push-state').setAttribute('prefetch', '');

  document.querySelectorAll('.sidebar a[href^="/"]').forEach(function (el) { 
    el.addEventListener('click', function (e) {
      if (el.pathname === window.location.pathname) {
        e.preventDefault();
        e.stopPropagation();
        document.querySelector('hy-drawer').close();
      }
    });
  });
</script> -->

<!--
Code for integrating CloudFlare's email protection with Hydejack's single page app loading.
-->
<script>
  document.getElementById('_pushState').addEventListener('hy-push-state-after', function (e) {
    function e(e){
      (console.error?console.error:console.log).call(console,e)
    }

    function t(e){
      return l.innerHTML='<a href="'+e.replace(/"/g,"&quot;")+'"></a>',l.childNodes[0].getAttribute("href")
    }

    function r(e,t){
      var r=e.substr(t,2);return parseInt(r,16)
    }

    function n(e,n){
      for(var o="",c=r(e,n),a=n+2;a<e.length;a+=2){
        var l=r(e,a)^c;
        o+=String.fromCharCode(l)
      }
      return t(o)
    }

    var o="/cdn-cgi/l/email-protection#",
        c=".__cf_email__",
        a="data-cfemail",
        l=document.createElement("div");

    !function(){
      for(var t=document.getElementsByTagName("a"),r=0;r<t.length;r++)
        try{
          var c=t[r],a=c.href.indexOf(o);
          a>-1&&(c.href="mailto:"+n(c.href,a+o.length))
        }catch(t){
          e(t)
        }
    }(),
    function(){
      for(var t=document.querySelectorAll(c),r=0;r<t.length;r++)
        try{
          var o=t[r],l=n(o.getAttribute(a),0),i=document.createTextNode(l);
          o.parentNode.replaceChild(i,o)
        }catch(t){
          e(t)
        }
    }()
  });
</script>





<div hidden>
  
  <h2 class="sr-only">Templates (for web app):</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loading…</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Oops</h1>
    
    
    <p class="lead">
      Oops, an error occurred while loading <a class="this-link" href=""></a>.

    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
    <template id="_cookies-banner-template">
  <div id="_cookies-banner" class="navbar fixed-bottom CookiesOK">
    <div class="content">
      <div class="nav-btn-bar">
        <small class="faded">
          <span>This site uses cookies. For more information, see the <a href="/legal/cookies/">Cookies Policy</a>.
</span>
          <button id="_cookies-ok" class="btn btn-primary btn-sm">Ok</button>
        </small>
      </div>
    </div>
  </div>
</template>

  
  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover" >
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
  
    <template id="_search-template">
  <button id="_search" class="nav-btn no-hover">
    <label class="sr-only" for="_search-input">Search</label>
    <span class="icon-search"></span>
  </button>
  <div id="_search-box">
    <div class="nav-btn">
      <span class="icon-search"></span>
    </div>
    <input 
      id="_search-input"
      type="search"
      class="form-control form-control-lg nav-btn"
      placeholder="Build with JEKYLL_ENV=production to enable search."
    />
    <button type="reset" class="nav-btn no-hover">
      <span class="sr-only">Close</span>
      <span class="icon-cross"></span>
    </button>
  </div>
  <div id="_hits"></div>
</template>

  
</div>

</body>
</html>
